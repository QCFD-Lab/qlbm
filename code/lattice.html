
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lattices and Geometry &#8212; qlbm 0.0.6 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=b4fc2567" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=1fd71caa"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'code/lattice';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Base Classes" href="comps_base.html" />
    <link rel="prev" title="Internal Documentation" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">qlbm 0.0.6 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Internal Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/qcfd-lab/qlbm" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/qlbm/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Internal Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/qcfd-lab/qlbm" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/qlbm/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lattices and Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="comps_base.html">Base Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="comps_cqlbm.html">Amplitude-Based Circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="comps_lga.html">QLGA Circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="infra.html">Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Other Tools</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Internal Documentation</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Lattices and Geometry</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="lattices-and-geometry">
<span id="lattice"></span><h1>Lattices and Geometry<a class="headerlink" href="#lattices-and-geometry" title="Link to this heading">#</a></h1>
<p>This page contains documentation about <a class="reference internal" href="#lattices"><span class="std std-ref">Lattices</span></a> and <a class="reference internal" href="#geometry"><span class="std std-ref">Geometry</span></a> classes of <code class="docutils literal notranslate"><span class="pre">qlbm</span></code>.
Lattices and geometry go hand-in-hand in that they do not themselves contain
quantum components, but instead provide a convenient interface
for accessing the information that determines the structure and composition of quantum components.
<code class="docutils literal notranslate"><span class="pre">qlbm</span></code> supports the following kinds of lattices:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Amplitude-Based (AB) lattices. These are the most common encdoings in QLBM literature. All AB lattices compress the grid into logarithmically many qubits.</dt><dd><ol class="arabic simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">AmpltiudeLattice</span></code> is the abstract base class for all amplitude-based lattices.</p></li>
<li><p><a class="reference internal" href="#qlbm.lattice.lattices.ab_lattice.ABLattice" title="qlbm.lattice.lattices.ab_lattice.ABLattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABLattice</span></code></a> is the “standard” amplitude-based lattice, where both the grid and the velocities are logarithmically compressed. It supports only <span class="math notranslate nohighlight">\(D_dQ_q\)</span> discretization.</p></li>
<li><p><a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice" title="qlbm.lattice.lattices.ms_lattice.MSLattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">MSLattice</span></code></a> is the multi-speed lattice for the algorithm described in <span id="id1">Schalkers and Möller [<a class="reference internal" href="../index.html#id10" title="Merel A. Schalkers and Matthias Möller. Efficient and fail-safe quantum algorithm for the transport equation. Journal of Computational Physics, 502:112816, 2024.">5</a>]</span>. It is the same as the <a class="reference internal" href="#qlbm.lattice.lattices.ab_lattice.ABLattice" title="qlbm.lattice.lattices.ab_lattice.ABLattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABLattice</span></code></a>, except it supports different velocity discretizations.</p></li>
<li><p><a class="reference internal" href="#qlbm.lattice.lattices.oh_lattice.OHLattice" title="qlbm.lattice.lattices.oh_lattice.OHLattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">OHLattice</span></code></a> is the amplitude-based lattice where the grid is logarithmically compressed, but the <span class="math notranslate nohighlight">\(D_dQ_q\)</span> velocities are not. It assigns one basis state per discrete velocity.</p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>LGA lattices. These rely on the computational basis state encoding (CBSE) and are used for QLGA algorithms.</dt><dd><ol class="arabic simple">
<li><p><a class="reference internal" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice" title="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeLattice</span></code></a> is the realization of the space-time data encoding described in <span id="id2">[<a class="reference internal" href="../index.html#id11" title="Merel A. Schalkers and Matthias Möller. On the importance of data encoding in quantum boltzmann methods. Quantum Information Processing, 23(1):20, 2024.">7</a>]</span> and <span id="id3">[<a class="reference internal" href="../index.html#id14" title="Călin A Georgescu, Merel A Schalkers, and Matthias Möller. Fully quantum lattice gas automata building blocks for computational basis state encodings. arXiv preprint arXiv:2506.12662, 2025.">1</a>]</span>. It uses an expanded CBSE to accomodate multiple time steps.</p></li>
<li><p><a class="reference internal" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice" title="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">LQLGALattice</span></code></a> is the entirely uncompressed CBSE, encoding all velocity channels in the system.</p></li>
</ol>
</dd>
</dl>
</li>
</ol>
<section id="lattices">
<span id="id4"></span><h2>Lattices<a class="headerlink" href="#lattices" title="Link to this heading">#</a></h2>
<p>Lattices are the backbone of <code class="docutils literal notranslate"><span class="pre">qlbm</span></code> quantum components.
While they do not contain quantum circuits themselves, lattices encode the information that
makes implementing and extending QLBM quantum circuits seamless.
Concretely, each <a class="reference internal" href="comps_base.html#qlbm.lattice.lattices.base.Lattice" title="qlbm.lattice.lattices.base.Lattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lattice</span></code></a> fulfills the following functionality:</p>
<ol class="arabic simple">
<li><p>Infers the number of qubits required to construct a quantum circuit based on a user specification.</p></li>
<li><p>Warn the user of invalid or ill-formed specifications.</p></li>
<li><p>Group the qubits into separate quantum registers according to their functionality.</p></li>
<li><p>Provide convenient indexing methods methods to access individual (or groups of) qubits based on their purpose.</p></li>
<li><p>Encode additional information required for the automatic assembly of large quantum circuits.</p></li>
</ol>
<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.lattices.ms_lattice.</span></span><span class="sig-name descname"><span class="pre">MSLattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger=&lt;Logger</span> <span class="pre">qlbm</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ms_lattice.py#L17-L471"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice" title="Link to this definition">#</a></dt>
<dd><p>Implementation of the <a class="reference internal" href="comps_base.html#qlbm.lattice.lattices.base.Lattice" title="qlbm.lattice.lattices.base.Lattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lattice</span></code></a> base specific to the 2D and 3D <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ms.MSQLBM" title="qlbm.components.ms.MSQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">MSQLBM</span></code></a> algorithm developed by <span id="id5">Schalkers and Möller [<a class="reference internal" href="../index.html#id10" title="Merel A. Schalkers and Matthias Möller. Efficient and fail-safe quantum algorithm for the transport equation. Journal of Computational Physics, 502:112816, 2024.">5</a>]</span>.</p>
<p>This lattice is only built from multi-speed specifications.
For <span class="math notranslate nohighlight">\(D_dQ_q\)</span> implementations, see <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ab.ABQLBM" title="qlbm.components.ab.ABQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABQLBM</span></code></a>.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Summary</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.num_dims" title="qlbm.lattice.lattices.ms_lattice.MSLattice.num_dims"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_dims</span></code></a></p></td>
<td><p>The number of dimensions of the lattice.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.num_gridpoints" title="qlbm.lattice.lattices.ms_lattice.MSLattice.num_gridpoints"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_gridpoints</span></code></a></p></td>
<td><p>A <code class="docutils literal notranslate"><span class="pre">List[int]</span></code> of the number of gridpoints of the lattice in each dimension.
<strong>Important</strong>: for easier compatibility with binary arithmetic, the number of gridpoints
specified in the input dictionary is one larger than the one held in the <code class="docutils literal notranslate"><span class="pre">Lattice</span></code>.
That is, for a <code class="docutils literal notranslate"><span class="pre">16x64</span></code> lattice, the <code class="docutils literal notranslate"><span class="pre">num_gridpoints</span></code> attribute will have the value <code class="docutils literal notranslate"><span class="pre">[15,</span> <span class="pre">63]</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_grid_qubits</span></code></p></td>
<td><p>The total number of qubits required to encode the lattice grid.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_velocity_qubits</span></code></p></td>
<td><p>The total number of qubits required to encode the velocity discretization of the lattice.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_ancilla_qubits</span></code></p></td>
<td><p>The total number of ancilla (non-velocity, non-grid) qubits required for the quantum circuit to simulate this lattice.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.num_total_qubits" title="qlbm.lattice.lattices.ms_lattice.MSLattice.num_total_qubits"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_total_qubits</span></code></a></p></td>
<td><p>The total number of qubits required for the quantum circuit to simulate the lattice.
This is the sum of the number of grid, velocity, and ancilla qubits.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">registers</span></code></p></td>
<td><p>A <code class="docutils literal notranslate"><span class="pre">Tuple[qiskit.QuantumRegister,</span> <span class="pre">...]</span></code> that holds registers responsible for specific operations of the QLBM algorithm.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">circuit</span></code></p></td>
<td><p>An empty <code class="docutils literal notranslate"><span class="pre">qiskit.QuantumCircuit</span></code> with labeled registers that quantum components use as a base.
Each quantum component that is parameterized by a <code class="docutils literal notranslate"><span class="pre">Lattice</span></code> makes a copy of this quantum circuit
to which it appends its designated logic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">shapes</span></code></p></td>
<td><p>A <code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">List[Shape]]</span></code> that contains all of the <a class="reference internal" href="comps_base.html#qlbm.lattice.geometry.shapes.base.Shape" title="qlbm.lattice.geometry.shapes.base.Shape"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shape</span></code></a>s encoding the solid geometry of the lattice.
The key of the dictionary is the specific kind of boundary condition of the obstacle (i.e., <code class="docutils literal notranslate"><span class="pre">&quot;bounceback&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;specular&quot;</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.logger" title="qlbm.lattice.lattices.ms_lattice.MSLattice.logger"><code class="xref py py-attr docutils literal notranslate"><span class="pre">logger</span></code></a></p></td>
<td><p>The performance logger, by default <code class="docutils literal notranslate"><span class="pre">getLogger(&quot;qlbm&quot;)</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The registers encoded in the lattice and their accessors are given below.
For the size of each register,
<span class="math notranslate nohighlight">\(N_{g_j}\)</span> is the number of grid points of dimension <span class="math notranslate nohighlight">\(j\)</span> (i.e., 64, 128),
<span class="math notranslate nohighlight">\(N_{v_j}\)</span> is the number of discrete velocities of dimension <span class="math notranslate nohighlight">\(j\)</span> (i.e., 2, 4),
and <span class="math notranslate nohighlight">\(d\)</span> is the total number of dimensions: 2 or 3.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id9">
<caption><span class="caption-text">Register allocation</span><a class="headerlink" href="#id9" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Register</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Access Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">ancilla_velocity_register</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(d\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_velocity_index" title="qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_velocity_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ancillae_velocity_index()</span></code></a></p></td>
<td><p>The qubits controlling the streaming operation based on the CFL counter.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">ancilla_obstacle_register</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(d\)</span> or <span class="math notranslate nohighlight">\(1\)</span>, See <a class="reference internal" href="#adaptability"><span class="std std-ref">Adaptable Lattice Register</span></a>.</p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_obstacle_index" title="qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_obstacle_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ancillae_obstacle_index()</span></code></a></p></td>
<td><p>The qubits used to detect whether particles have streamed into obstacles. Used for reflection.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">ancilla_comparator_register</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(2(d-1)\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_comparator_index" title="qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_comparator_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ancillae_comparator_index()</span></code></a></p></td>
<td><p>The qubits used to for <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ms.primitives.Comparator" title="qlbm.components.ms.primitives.Comparator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Comparator</span></code></a>s. Used for reflection.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">grid_registers</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\Sigma_{1\leq j \leq d} \left \lceil{\log N_{g_j}} \right \rceil\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.grid_index" title="qlbm.lattice.lattices.ms_lattice.MSLattice.grid_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">grid_index()</span></code></a></p></td>
<td><p>The qubits encoding the physical grid.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocity_registers</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\Sigma_{1\leq j \leq d} \left \lceil{\log N_{v_j}} \right \rceil - 1\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.velocity_index" title="qlbm.lattice.lattices.ms_lattice.MSLattice.velocity_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">velocity_index()</span></code></a></p></td>
<td><p>The qubits encoding speeds.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocity_dir_registers</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(d\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.velocity_dir_index" title="qlbm.lattice.lattices.ms_lattice.MSLattice.velocity_dir_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">velocity_dir_index()</span></code></a></p></td>
<td><p>The qubits encoding velocity direction (positive or negative).</p></td>
</tr>
</tbody>
</table>
</div>
<section id="adaptable-lattice-register">
<span id="adaptability"></span><h3>Adaptable Lattice Register<a class="headerlink" href="#adaptable-lattice-register" title="Link to this heading">#</a></h3>
<p>The <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ms.bounceback_reflection.BounceBackReflectionOperator" title="qlbm.components.ms.bounceback_reflection.BounceBackReflectionOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BounceBackReflectionOperator</span></code></a> and <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ms.specular_reflection.SpecularReflectionOperator" title="qlbm.components.ms.specular_reflection.SpecularReflectionOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpecularReflectionOperator</span></code></a> have different requirements for the number of qubits.
If a lattice contains at least one SR-conditioned object, then <span class="math notranslate nohighlight">\(d\)</span> ancilla qubits are required
to flag whether the particle has collided with the surface of the object, its edge (in 3D), or its corner.
This information influences which directional qubits are inverted.</p>
<p>The BB boundary conditions are simpler in that they only require <span class="math notranslate nohighlight">\(1\)</span> ancilla qubit
to detect whether a particle has collided with the object.
All velocities are inverted, irrespective of the interaction with the object.
As such, if only the lattice only contains BB objects, a single
ancilla qubit is required for reflection across all objects.
The lattice object infers this at construction time and adjusts the
relative index of all other registers accordingly.</p>
<p>A lattice can be constructed from from either an input file or a Python dictionary.
A sample configuration might look as follows:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;lattice&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;dim&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;velocities&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;geometry&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;boundary&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;specular&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;boundary&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bounceback&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The register setup can be visualized by constructing a lattice object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qlbm.lattice</span><span class="w"> </span><span class="kn">import</span> <span class="n">MSLattice</span>

<span class="n">MSLattice</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;lattice&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;dim&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span> <span class="s2">&quot;velocities&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}},</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;shape&quot;</span><span class="p">:</span><span class="s2">&quot;cuboid&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;boundary&quot;</span><span class="p">:</span> <span class="s2">&quot;bounceback&quot;</span><span class="p">}],</span>
    <span class="p">}</span>
<span class="p">)</span><span class="o">.</span><span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/9f62098c7162ace0437ac07029e7419b/lattice-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/7cfc87fd1cb83c09416d5816ce6c8e7a/lattice-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/ae039ebd0eefed3f13319d7b9630e282/lattice-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/ad40e78dc3f83028d6110715a20a7c80/lattice-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/lattice-1.png" class="plot-directive" src="../_images/lattice-1.png" />
</figure>
<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></em><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.logger" title="Link to this definition">#</a></dt>
<dd><p>The performance logger, by default <code class="docutils literal notranslate"><span class="pre">getLogger(&quot;qlbm&quot;)</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.num_dims">
<span class="sig-name descname"><span class="pre">num_dims</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.num_dims" title="Link to this definition">#</a></dt>
<dd><p>The number of dimensions of the system.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.num_gridpoints">
<span class="sig-name descname"><span class="pre">num_gridpoints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.num_gridpoints" title="Link to this definition">#</a></dt>
<dd><p>The number of gridpoints of the lattice in each dimension.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For easier compatibility with binary arithmetic, the number of gridpoints
specified in the input dictionary is one larger than the one held in the <a class="reference internal" href="comps_base.html#qlbm.lattice.lattices.base.Lattice" title="qlbm.lattice.lattices.base.Lattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lattice</span></code></a> s.
That is, for a <span class="math notranslate nohighlight">\(16 \times 64\)</span> lattice, the <code class="docutils literal notranslate"><span class="pre">num_gridpoints</span></code> attribute will have the value <code class="docutils literal notranslate"><span class="pre">[15,</span> <span class="pre">63]</span></code>.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.num_velocities">
<span class="sig-name descname"><span class="pre">num_velocities</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.num_velocities" title="Link to this definition">#</a></dt>
<dd><p>The number of velocities in each dimension. This will be refactored in the future to support <span class="math notranslate nohighlight">\(D_dQ_q\)</span> discretizations.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For easier compatibility with binary arithmetic, the number of velocities
specified in the input dictionary is one larger than the one held in the <a class="reference internal" href="comps_base.html#qlbm.lattice.lattices.base.Lattice" title="qlbm.lattice.lattices.base.Lattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lattice</span></code></a> s.
If the numbers of discrete velocities are <span class="math notranslate nohighlight">\(4\)</span> and <span class="math notranslate nohighlight">\(2\)</span>, the <code class="docutils literal notranslate"><span class="pre">num_velocities</span></code> attribute will have the value <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">1]</span></code>.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.num_total_qubits">
<span class="sig-name descname"><span class="pre">num_total_qubits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.num_total_qubits" title="Link to this definition">#</a></dt>
<dd><p>The total number of qubits required for the quantum circuit to simulate the lattice. This is the sum of the number of grid, velocity, and ancilla qubits.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_velocity_index">
<span class="sig-name descname"><span class="pre">ancillae_velocity_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ms_lattice.py#L207-L235"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_velocity_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used as velocity ancillae for the specified dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The dimension of the grid for which to retrieve the velocity qubit indices, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
When <code class="docutils literal notranslate"><span class="pre">dim</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of ancillae qubits for all dimensions are returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used as velocity ancillae for the given dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_obstacle_index">
<span class="sig-name descname"><span class="pre">ancillae_obstacle_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ms_lattice.py#L237-L248"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_obstacle_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used as obstacle ancilla for the specified dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The index of the grid for which to retrieve the obstacle qubit index, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
When <code class="docutils literal notranslate"><span class="pre">index</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of ancillae qubits for all dimensions are returned.
For 2D lattices with only bounce-back boundary-conditions, only one obstacle
qubit is required.
For all other configurations, the algorithm uses <code class="docutils literal notranslate"><span class="pre">2d-2</span></code> obstacle qubits.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used as obstacle ancilla for the given dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_comparator_index">
<span class="sig-name descname"><span class="pre">ancillae_comparator_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ms_lattice.py#L250-L270"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_comparator_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used as comparator ancillae for the specified index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The index for which to retrieve the comparator qubit indices, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
There are <cite>num_dims-1</cite> available indices (i.e., 1 for 2D and 2 for 3D).
When <cite>index</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of ancillae qubits for all dimensions are returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used as obstacle ancilla for the given dimension.
By convention, the 0th qubit in the returned list is used
for lower bound comparison and the 1st is used for upper bound comparisons.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.grid_index">
<span class="sig-name descname"><span class="pre">grid_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ms_lattice.py#L272-L298"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.grid_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used that encode the grid values for the specified dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The dimension of the grid for which to retrieve the grid qubit indices, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
When <code class="docutils literal notranslate"><span class="pre">dim</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of all grid qubits for all dimensions are returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used to encode the grid values for the given dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.velocity_index">
<span class="sig-name descname"><span class="pre">velocity_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ms_lattice.py#L300-L338"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.velocity_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used that encode the velocity magnitude values for the specified dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The dimension of the grid for which to retrieve the velocity qubit indices, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
When <code class="docutils literal notranslate"><span class="pre">dim</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of all velocity qubits for all dimensions are returned.
Note: <code class="docutils literal notranslate"><span class="pre">dim</span></code> should only only be supplied to the MSLattice.
Other amplitude lattices do not support a dimensional breakdown, and <code class="docutils literal notranslate"><span class="pre">dim</span></code> should not be passed as an argument.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used to encode the velocity magnitude values for the given dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.velocity_dir_index">
<span class="sig-name descname"><span class="pre">velocity_dir_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ms_lattice.py#L340-L385"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.velocity_dir_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubit that encodes the velocity direction values for the specified dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The dimension of the grid for which to retrieve the velocity direction qubit index, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
When <code class="docutils literal notranslate"><span class="pre">dim</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of all velocity direction qubits for all dimensions are returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used to encode the velocity direction for the given dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.get_registers">
<span class="sig-name descname"><span class="pre">get_registers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ms_lattice.py#L387-L437"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.get_registers" title="Link to this definition">#</a></dt>
<dd><p>Generates the encoding-specific register required for the streaming step.</p>
<p>For this encoding, different registers encode (i) the velocity direction,
(ii) the velocity discretization, (iii) the velocity ancillae,
and (iv) the grid encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[QuantumRegister]: The 4-tuple of qubit registers encoding the streaming step.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.logger_name">
<span class="sig-name descname"><span class="pre">logger_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ms_lattice.py#L456-L463"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.logger_name" title="Link to this definition">#</a></dt>
<dd><p>An identifiable name to be used in the logger to help with benchmarking and analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string that can be used to sufficiently identify the lattice specification.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.has_multiple_geometries">
<span class="sig-name descname"><span class="pre">has_multiple_geometries</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ms_lattice.py#L465-L467"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.has_multiple_geometries" title="Link to this definition">#</a></dt>
<dd><p>Whether multiple lattice geometries are simulated simultaneously.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether multiple lattice geometries are simulated simultaneously.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ms_lattice.MSLattice.get_encoding">
<span class="sig-name descname"><span class="pre">get_encoding</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ms_lattice.py#L469-L471"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.get_encoding" title="Link to this definition">#</a></dt>
<dd><p>Get the type of encoding this lattice implements.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The encoding of this lattice.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ABEncodingType</p>
</dd>
</dl>
</dd></dl>

</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lattice_data</strong> (<em>str</em><em> | </em><em>Dict</em>)</p></li>
<li><p><strong>logger</strong> (<em>Logger</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.lattices.ab_lattice.</span></span><span class="sig-name descname"><span class="pre">ABLattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger=&lt;Logger</span> <span class="pre">qlbm</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ab_lattice.py#L22-L311"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice" title="Link to this definition">#</a></dt>
<dd><p>Implementation of the <a class="reference internal" href="comps_base.html#qlbm.lattice.lattices.base.Lattice" title="qlbm.lattice.lattices.base.Lattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lattice</span></code></a> base specific to the 2D and 3D <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ab.ABQLBM" title="qlbm.components.ab.ABQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABQLBM</span></code></a> algorithm developed in <span id="id6">Schalkers and Möller [<a class="reference internal" href="../index.html#id10" title="Merel A. Schalkers and Matthias Möller. Efficient and fail-safe quantum algorithm for the transport equation. Journal of Computational Physics, 502:112816, 2024.">5</a>]</span>.</p>
<p>This lattice is only built from <span class="math notranslate nohighlight">\(D_dQ_q\)</span> specifications.
For multi-speed implementations, see <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ms.MSQLBM" title="qlbm.components.ms.MSQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">MSQLBM</span></code></a>.</p>
<p>The registers encoded in the lattice and their accessors are given below.
For the size of each register,
<span class="math notranslate nohighlight">\(N_{g_j}\)</span> is the number of grid points of dimension <span class="math notranslate nohighlight">\(j\)</span> (i.e., 64, 128),
<span class="math notranslate nohighlight">\(q\)</span> is the number of discrete velocities, for instance, 9.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id10">
<caption><span class="caption-text">Register allocation</span><a class="headerlink" href="#id10" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Register</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Access Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">grid_registers</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\Sigma_{1\leq j \leq d} \left \lceil{\log N_{g_j}} \right \rceil\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.grid_index" title="qlbm.lattice.lattices.ab_lattice.ABLattice.grid_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">grid_index()</span></code></a></p></td>
<td><p>The qubits encoding the physical grid.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocity_registers</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\lceil\log_2 q \rceil\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.velocity_index" title="qlbm.lattice.lattices.ab_lattice.ABLattice.velocity_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">velocity_index()</span></code></a></p></td>
<td><p>The qubits encoding the <span class="math notranslate nohighlight">\(q\)</span> discrete velocities.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">ancilla_obstacle_register</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.ancillae_obstacle_index" title="qlbm.lattice.lattices.ab_lattice.ABLattice.ancillae_obstacle_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ancillae_obstacle_index()</span></code></a></p></td>
<td><p>The qubits used to detect whether particles have streamed into obstacles. Used for reflection.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">ancilla_comparator_register</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(2(d-1)\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.ancillae_comparator_index" title="qlbm.lattice.lattices.ab_lattice.ABLattice.ancillae_comparator_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ancillae_comparator_index()</span></code></a></p></td>
<td><p>The qubits used to for <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ms.primitives.Comparator" title="qlbm.components.ms.primitives.Comparator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Comparator</span></code></a>s. Used for reflection.</p></td>
</tr>
</tbody>
</table>
</div>
<p>A lattice can be constructed from from either an input file or a Python dictionary:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;lattice&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;dim&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;velocities&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d2q9&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;geometry&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;boundary&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bounceback&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;boundary&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bounceback&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The register setup can be visualized by constructing a lattice object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qlbm.lattice</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABLattice</span>

<span class="n">ABLattice</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;lattice&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;dim&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span> <span class="s2">&quot;velocities&quot;</span><span class="p">:</span> <span class="s2">&quot;D2Q9&quot;</span><span class="p">},</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
<span class="p">)</span><span class="o">.</span><span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/d425555e37d056388c1e4ac9acd51599/lattice-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/d4d6176a27ecc4370eca489a3b024316/lattice-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/4c245afcd8a2a0d37a6a8da069f3a8b0/lattice-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/4cfe63ac88cbf7cbc10e1f818add51b8/lattice-2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/lattice-2.png" class="plot-directive" src="../_images/lattice-2.png" />
</figure>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logger</strong> (<em>Logger</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.num_gridpoints">
<span class="sig-name descname"><span class="pre">num_gridpoints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.num_gridpoints" title="Link to this definition">#</a></dt>
<dd><p>The number of gridpoints in each dimension of the lattice.
<strong>Important</strong> : for easier compatibility with binary arithmetic, the number of gridpoints
specified in the input dictionary is one larger than the one held in the <code class="docutils literal notranslate"><span class="pre">Lattice</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.shapes">
<span class="sig-name descname"><span class="pre">shapes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><a class="reference internal" href="comps_base.html#qlbm.lattice.geometry.shapes.base.Shape" title="qlbm.lattice.geometry.shapes.base.Shape"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shape</span></code></a><span class="pre">]]</span></em><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.shapes" title="Link to this definition">#</a></dt>
<dd><p>The shapes of the lattice, which are used to define the geometry of the lattice.
The key consists of the type of the shape and the name of the shape, e.g. “bounceback” or “specular”.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.discretization">
<span class="sig-name descname"><span class="pre">discretization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="comps_lga.html#qlbm.lattice.spacetime.properties_base.LatticeDiscretization" title="qlbm.lattice.spacetime.properties_base.LatticeDiscretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">LatticeDiscretization</span></code></a></em><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.discretization" title="Link to this definition">#</a></dt>
<dd><p>The discretization of the lattice, one of <a class="reference internal" href="comps_lga.html#qlbm.lattice.spacetime.properties_base.LatticeDiscretization" title="qlbm.lattice.spacetime.properties_base.LatticeDiscretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">LatticeDiscretization</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.num_base_qubits">
<span class="sig-name descname"><span class="pre">num_base_qubits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.num_base_qubits" title="Link to this definition">#</a></dt>
<dd><p>The number of qubits required to represent the lattice.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.registers">
<span class="sig-name descname"><span class="pre">registers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumRegister</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code><span class="pre">]</span></em><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.registers" title="Link to this definition">#</a></dt>
<dd><p>The registers of the lattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.grid_index">
<span class="sig-name descname"><span class="pre">grid_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ab_lattice.py#L163-L183"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.grid_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used that encode the grid values for the specified dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The dimension of the grid for which to retrieve the grid qubit indices, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
When <code class="docutils literal notranslate"><span class="pre">dim</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of all grid qubits for all dimensions are returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used to encode the grid values for the given dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.velocity_index">
<span class="sig-name descname"><span class="pre">velocity_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ab_lattice.py#L185-L196"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.velocity_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used that encode the velocity magnitude values for the specified dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The dimension of the grid for which to retrieve the velocity qubit indices, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
When <code class="docutils literal notranslate"><span class="pre">dim</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of all velocity qubits for all dimensions are returned.
Note: <code class="docutils literal notranslate"><span class="pre">dim</span></code> should only only be supplied to the MSLattice.
Other amplitude lattices do not support a dimensional breakdown, and <code class="docutils literal notranslate"><span class="pre">dim</span></code> should not be passed as an argument.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used to encode the velocity magnitude values for the given dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.ancillae_comparator_index">
<span class="sig-name descname"><span class="pre">ancillae_comparator_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ab_lattice.py#L198-L217"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.ancillae_comparator_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used as comparator ancillae for the specified index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The index for which to retrieve the comparator qubit indices, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
There are <cite>num_dims-1</cite> available indices (i.e., 1 for 2D and 2 for 3D).
When <cite>index</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of ancillae qubits for all dimensions are returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used as obstacle ancilla for the given dimension.
By convention, the 0th qubit in the returned list is used
for lower bound comparison and the 1st is used for upper bound comparisons.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.ancillae_obstacle_index">
<span class="sig-name descname"><span class="pre">ancillae_obstacle_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ab_lattice.py#L219-L236"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.ancillae_obstacle_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used as obstacle ancilla for the specified dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The index of the grid for which to retrieve the obstacle qubit index, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
When <code class="docutils literal notranslate"><span class="pre">index</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of ancillae qubits for all dimensions are returned.
For 2D lattices with only bounce-back boundary-conditions, only one obstacle
qubit is required.
For all other configurations, the algorithm uses <code class="docutils literal notranslate"><span class="pre">2d-2</span></code> obstacle qubits.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used as obstacle ancilla for the given dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.get_registers">
<span class="sig-name descname"><span class="pre">get_registers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ab_lattice.py#L255-L294"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.get_registers" title="Link to this definition">#</a></dt>
<dd><p>Generates the encoding-specific register required for the streaming step.</p>
<p>For this encoding, different registers encode
(i) the logarithmically compressed grid,
(ii) the logarithmically compressed discrete velocities,
(iii) the comparator qubits,
(iv) the object qubits.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[QuantumRegister]: The 4-tuple of qubit registers encoding the streaming step.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.logger_name">
<span class="sig-name descname"><span class="pre">logger_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ab_lattice.py#L296-L303"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.logger_name" title="Link to this definition">#</a></dt>
<dd><p>An identifiable name to be used in the logger to help with benchmarking and analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string that can be used to sufficiently identify the lattice specification.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.has_multiple_geometries">
<span class="sig-name descname"><span class="pre">has_multiple_geometries</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ab_lattice.py#L305-L307"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.has_multiple_geometries" title="Link to this definition">#</a></dt>
<dd><p>Whether multiple lattice geometries are simulated simultaneously.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether multiple lattice geometries are simulated simultaneously.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.ab_lattice.ABLattice.get_encoding">
<span class="sig-name descname"><span class="pre">get_encoding</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/ab_lattice.py#L309-L311"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.get_encoding" title="Link to this definition">#</a></dt>
<dd><p>Get the type of encoding this lattice implements.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The encoding of this lattice.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ABEncodingType</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.oh_lattice.OHLattice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.lattices.oh_lattice.</span></span><span class="sig-name descname"><span class="pre">OHLattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger=&lt;Logger</span> <span class="pre">qlbm</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/oh_lattice.py#L22-L245"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.oh_lattice.OHLattice" title="Link to this definition">#</a></dt>
<dd><p>Implementation of the <a class="reference internal" href="comps_base.html#qlbm.lattice.lattices.base.Lattice" title="qlbm.lattice.lattices.base.Lattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lattice</span></code></a> base specific to the 2D and 3D <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ab.ABQLBM" title="qlbm.components.ab.ABQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABQLBM</span></code></a> for the One-Hot (OH) encoding.</p>
<p>In the OH encoding, the grid is compressed into logarithmically many qubits,
while the the velocity register is not.
For a <span class="math notranslate nohighlight">\(1024 \times 1024\)</span> lattice with a <span class="math notranslate nohighlight">\(D_2Q_9\)</span> discretization, the
OH encoding requires <span class="math notranslate nohighlight">\(2\log_2 1024 + 9 = 29\)</span> qubits.</p>
<p>Each of the discrete velocities is assigned a vector <span class="math notranslate nohighlight">\(\ket{\mathbf{e}_j}\)</span>,
with entry <span class="math notranslate nohighlight">\(1\)</span> at index <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(0\)</span> everywhere else.</p>
<p>This lattice is only built from <span class="math notranslate nohighlight">\(D_dQ_q\)</span> specifications.
For multi-speed implementations, see <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ms.MSQLBM" title="qlbm.components.ms.MSQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">MSQLBM</span></code></a> and <a class="reference internal" href="#qlbm.lattice.lattices.ms_lattice.MSLattice" title="qlbm.lattice.lattices.ms_lattice.MSLattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">MSLattice</span></code></a>.
For the fully compressed velocity register counterpart, see <a class="reference internal" href="#qlbm.lattice.lattices.ab_lattice.ABLattice" title="qlbm.lattice.lattices.ab_lattice.ABLattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABLattice</span></code></a>.</p>
<p>The registers encoded in the lattice and their accessors are given below.
For the size of each register,
<span class="math notranslate nohighlight">\(N_{g_j}\)</span> is the number of grid points of dimension <span class="math notranslate nohighlight">\(j\)</span> (i.e., 64, 128),
<span class="math notranslate nohighlight">\(q\)</span> is the number of discrete velocities, for instance, 9.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id11">
<caption><span class="caption-text">Register allocation</span><a class="headerlink" href="#id11" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Register</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Access Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">grid_registers</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\Sigma_{1\leq j \leq d} \left \lceil{\log N_{g_j}} \right \rceil\)</span></p></td>
<td><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">grid_index()</span></code></p></td>
<td><p>The qubits encoding the physical grid.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocity_registers</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(q\)</span></p></td>
<td><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">velocity_index()</span></code></p></td>
<td><p>The qubits encoding the <span class="math notranslate nohighlight">\(q\)</span> discrete velocities.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">ancilla_obstacle_register</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">ancillae_obstacle_index()</span></code></p></td>
<td><p>The qubits used to detect whether particles have streamed into obstacles. Used for reflection.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">ancilla_comparator_register</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(2(d-1)\)</span></p></td>
<td><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">ancillae_comparator_index()</span></code></p></td>
<td><p>The qubits used to for <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ms.primitives.Comparator" title="qlbm.components.ms.primitives.Comparator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Comparator</span></code></a>s. Used for reflection.</p></td>
</tr>
</tbody>
</table>
</div>
<p>A lattice can be constructed from from either an input file or a Python dictionary:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;lattice&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;dim&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;velocities&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d2q9&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;geometry&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;boundary&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bounceback&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;boundary&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bounceback&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The register setup can be visualized by constructing a lattice object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qlbm.lattice</span><span class="w"> </span><span class="kn">import</span> <span class="n">OHLattice</span>

<span class="n">OHLattice</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;lattice&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;dim&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span> <span class="s2">&quot;velocities&quot;</span><span class="p">:</span> <span class="s2">&quot;D2Q9&quot;</span><span class="p">},</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
<span class="p">)</span><span class="o">.</span><span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/fd3c6cc37c6f373054562e51811d33f0/lattice-3.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/3c802057b08e8247e0411633e605ed43/lattice-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/5c2c4aed0f0896f3ae185cd0dbd2c5cb/lattice-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/8f329888f6ce28ac5e321391c2111216/lattice-3.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/lattice-3.png" class="plot-directive" src="../_images/lattice-3.png" />
</figure>
<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.oh_lattice.OHLattice.num_gridpoints">
<span class="sig-name descname"><span class="pre">num_gridpoints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><a class="headerlink" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.num_gridpoints" title="Link to this definition">#</a></dt>
<dd><p>The number of gridpoints in each dimension of the lattice.
<strong>Important</strong> : for easier compatibility with binary arithmetic, the number of gridpoints
specified in the input dictionary is one larger than the one held in the <code class="docutils literal notranslate"><span class="pre">Lattice</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.oh_lattice.OHLattice.shapes">
<span class="sig-name descname"><span class="pre">shapes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><a class="reference internal" href="comps_base.html#qlbm.lattice.geometry.shapes.base.Shape" title="qlbm.lattice.geometry.shapes.base.Shape"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shape</span></code></a><span class="pre">]]</span></em><a class="headerlink" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.shapes" title="Link to this definition">#</a></dt>
<dd><p>The shapes of the lattice, which are used to define the geometry of the lattice.
The key consists of the type of the shape and the name of the shape, e.g. “bounceback” or “specular”.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.oh_lattice.OHLattice.discretization">
<span class="sig-name descname"><span class="pre">discretization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="comps_lga.html#qlbm.lattice.spacetime.properties_base.LatticeDiscretization" title="qlbm.lattice.spacetime.properties_base.LatticeDiscretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">LatticeDiscretization</span></code></a></em><a class="headerlink" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.discretization" title="Link to this definition">#</a></dt>
<dd><p>The discretization of the lattice, one of <a class="reference internal" href="comps_lga.html#qlbm.lattice.spacetime.properties_base.LatticeDiscretization" title="qlbm.lattice.spacetime.properties_base.LatticeDiscretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">LatticeDiscretization</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.oh_lattice.OHLattice.num_base_qubits">
<span class="sig-name descname"><span class="pre">num_base_qubits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.num_base_qubits" title="Link to this definition">#</a></dt>
<dd><p>The number of qubits required to represent the lattice.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.oh_lattice.OHLattice.registers">
<span class="sig-name descname"><span class="pre">registers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumRegister</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code><span class="pre">]</span></em><a class="headerlink" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.registers" title="Link to this definition">#</a></dt>
<dd><p>The registers of the lattice.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.oh_lattice.OHLattice.get_registers">
<span class="sig-name descname"><span class="pre">get_registers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/oh_lattice.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.get_registers" title="Link to this definition">#</a></dt>
<dd><p>Generates the encoding-specific register required for the streaming step.</p>
<p>For this encoding, different registers encode
(i) the logarithmically compressed grid,
(ii) the uncompressed discrete velocities,
(iii) the comparator qubits,
(iv) the object qubits.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[QuantumRegister]: The 4-tuple of qubit registers encoding the streaming step.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.oh_lattice.OHLattice.logger_name">
<span class="sig-name descname"><span class="pre">logger_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/oh_lattice.py#L213-L220"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.logger_name" title="Link to this definition">#</a></dt>
<dd><p>An identifiable name to be used in the logger to help with benchmarking and analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string that can be used to sufficiently identify the lattice specification.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.oh_lattice.OHLattice.has_multiple_geometries">
<span class="sig-name descname"><span class="pre">has_multiple_geometries</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/oh_lattice.py#L222-L224"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.has_multiple_geometries" title="Link to this definition">#</a></dt>
<dd><p>Whether multiple lattice geometries are simulated simultaneously.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether multiple lattice geometries are simulated simultaneously.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.oh_lattice.OHLattice.get_encoding">
<span class="sig-name descname"><span class="pre">get_encoding</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/oh_lattice.py#L226-L228"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.get_encoding" title="Link to this definition">#</a></dt>
<dd><p>Get the type of encoding this lattice implements.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The encoding of this lattice.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ABEncodingType</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.lattices.spacetime_lattice.</span></span><span class="sig-name descname"><span class="pre">SpaceTimeLattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_inside_blocks=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_measurement_qubit=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_volumetric_ops=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger=&lt;Logger</span> <span class="pre">qlbm</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/spacetime_lattice.py#L21-L475"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice" title="Link to this definition">#</a></dt>
<dd><p>Implementation of the <a class="reference internal" href="comps_base.html#qlbm.lattice.lattices.base.Lattice" title="qlbm.lattice.lattices.base.Lattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lattice</span></code></a> base specific to the 2D and 3D <a class="reference internal" href="comps_lga.html#qlbm.components.spacetime.spacetime.SpaceTimeQLBM" title="qlbm.components.spacetime.spacetime.SpaceTimeQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeQLBM</span></code></a> algorithm developed by <span id="id7">Schalkers and Möller [<a class="reference internal" href="../index.html#id11" title="Merel A. Schalkers and Matthias Möller. On the importance of data encoding in quantum boltzmann methods. Quantum Information Processing, 23(1):20, 2024.">7</a>]</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The STQBLM algorithm is a based on typical <span class="math notranslate nohighlight">\(D_dQ_q\)</span> discretizations.
The current implementation only supports <span class="math notranslate nohighlight">\(D_2Q_4\)</span> for one time step.
This is work in progress.
Multiple steps are possible through <code class="docutils literal notranslate"><span class="pre">qlbm</span></code>‘s reinitialization mechanism.</p>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Summary</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_timesteps</span></code></p></td>
<td><p>The number of time steps the lattice should be simulated for.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_dims</span></code></p></td>
<td><p>The number of dimensions of the lattice.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_gridpoints</span></code></p></td>
<td><p>A <code class="docutils literal notranslate"><span class="pre">List[int]</span></code> of the number of gridpoints of the lattice in each dimension.
<strong>Important</strong>: for easier compatibility with binary arithmetic, the number of gridpoints
specified in the input dictionary is one larger than the one held in the <code class="docutils literal notranslate"><span class="pre">Lattice</span></code>.
That is, for a <code class="docutils literal notranslate"><span class="pre">16x64</span></code> lattice, the <code class="docutils literal notranslate"><span class="pre">num_gridpoints</span></code> attribute will have the value <code class="docutils literal notranslate"><span class="pre">[15,</span> <span class="pre">63]</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_grid_qubits</span></code></p></td>
<td><p>The total number of qubits required to encode the lattice grid.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_velocity_qubits</span></code></p></td>
<td><p>The total number of qubits required to encode the velocity discretization of the lattice.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_ancilla_qubits</span></code></p></td>
<td><p>The total number of ancilla (non-velocity, non-grid) qubits required for the quantum circuit to simulate this lattice.
There are no ancilla qubits for the Space-Time QLBM.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_total_qubits</span></code></p></td>
<td><p>The total number of qubits required for the quantum circuit to simulate the lattice.
This is the sum of the number of grid, velocity, and ancilla qubits.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">registers</span></code></p></td>
<td><p>A <code class="docutils literal notranslate"><span class="pre">Tuple[qiskit.QuantumRegister,</span> <span class="pre">...]</span></code> that holds registers responsible for specific operations of the QLBM algorithm.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">circuit</span></code></p></td>
<td><p>An empty <code class="docutils literal notranslate"><span class="pre">qiskit.QuantumCircuit</span></code> with labeled registers that quantum components use as a base.
Each quantum component that is parameterized by a <code class="docutils literal notranslate"><span class="pre">Lattice</span></code> makes a copy of this quantum circuit
to which it appends its designated logic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">blocks</span></code></p></td>
<td><p>A <code class="docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">List[Block]]</span></code> that contains all of the <a class="reference internal" href="#qlbm.lattice.geometry.Block" title="qlbm.lattice.geometry.Block"><code class="xref py py-class docutils literal notranslate"><span class="pre">Block</span></code></a>s encoding the solid geometry of the lattice.
The key of the dictionary is the specific kind of boundary condition of the obstacle (i.e., <code class="docutils literal notranslate"><span class="pre">&quot;bounceback&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;specular&quot;</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">logger</span></code></p></td>
<td><p>The performance logger, by default <code class="docutils literal notranslate"><span class="pre">getLogger(&quot;qlbm&quot;)</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The registers encoded in the lattice and their accessors are given below.
For the size of each register,
<span class="math notranslate nohighlight">\(N_{g_j}\)</span> is the number of grid points of dimension <span class="math notranslate nohighlight">\(j\)</span> (i.e., 64, 128),
<span class="math notranslate nohighlight">\(N_{v_j}\)</span> is the number of discrete velocities of dimension <span class="math notranslate nohighlight">\(j\)</span> (i.e., 2, 4),
and <span class="math notranslate nohighlight">\(d\)</span> is the total number of dimensions: 2 or 3.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id12">
<caption><span class="caption-text">Register allocation</span><a class="headerlink" href="#id12" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Register</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Access Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">grid_registers</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\Sigma_{1\leq j \leq d} \left \lceil{\log N_{g_j}} \right \rceil\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.grid_index" title="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.grid_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">grid_index()</span></code></a></p></td>
<td><p>The qubits encoding the physical grid.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocity_registers</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\min(N_g \cdot N_v, \frac{N_v^2\cdot N_t \cdot (N_t + 1)}{2} + N_v)\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.velocity_index" title="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.velocity_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">velocity_index()</span></code></a></p></td>
<td><p>The qubits encoding local and neighboring velocities.</p></td>
</tr>
</tbody>
</table>
</div>
<p>A lattice can be constructed from from either an input file or a Python dictionary.
Currently, only the <span class="math notranslate nohighlight">\(D_2Q_4\)</span> discretization is supported, and no boundary conditions are implemented.
A sample configuration might look as follows. Keep in mind that the velocity and geometry section
should not be altered in this current implementation.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;lattice&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;dim&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;y&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;velocities&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;D2Q4&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;geometry&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The register setup can be visualized by constructing a lattice object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qlbm.lattice</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpaceTimeLattice</span>

<span class="n">SpaceTimeLattice</span><span class="p">(</span>
    <span class="n">num_timesteps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">lattice_data</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;lattice&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;dim&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span> <span class="s2">&quot;velocities&quot;</span><span class="p">:</span> <span class="s2">&quot;D2Q4&quot;</span><span class="p">},</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
<span class="p">)</span><span class="o">.</span><span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/67f0dd043d578a08317d786231b54900/lattice-4.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/754f402ce19b08dabf4bcda0336ed8e3/lattice-4.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/8cf0bb1fea3460b6a4b52760a5f3925d/lattice-4.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/48154bff3722d3a64accbff7e9e23e40/lattice-4.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/lattice-4.png" class="plot-directive" src="../_images/lattice-4.png" />
</figure>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_timesteps</strong> (<em>int</em>)</p></li>
<li><p><strong>lattice_data</strong> (<em>str</em><em> | </em><em>Dict</em>)</p></li>
<li><p><strong>filter_inside_blocks</strong> (<em>bool</em>)</p></li>
<li><p><strong>include_measurement_qubit</strong> (<em>bool</em>)</p></li>
<li><p><strong>use_volumetric_ops</strong> (<em>bool</em>)</p></li>
<li><p><strong>logger</strong> (<em>Logger</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.grid_index">
<span class="sig-name descname"><span class="pre">grid_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/spacetime_lattice.py#L193-L226"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.grid_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used that encode the grid values for the specified dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The dimension of the grid for which to retrieve the grid qubit indices, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
When <code class="docutils literal notranslate"><span class="pre">dim</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of all grid qubits for all dimensions are returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used to encode the grid values for the given dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.velocity_index">
<span class="sig-name descname"><span class="pre">velocity_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point_neighborhood_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/spacetime_lattice.py#L228-L261"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.velocity_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used that encode the velocity for a specific neighboring grid point and direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point_neighborhood_index</strong> (<em>int</em>) – The index of the grid point neighbor.</p></li>
<li><p><strong>velocity_direction</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The index of the discrete velocity according to the LBM discretization, by default None.
When <code class="docutils literal notranslate"><span class="pre">velocity_direction</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of all velocity qubits of the neighbor are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits that encode the specific neighbor, velocity pair.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.ancilla_mass_index">
<span class="sig-name descname"><span class="pre">ancilla_mass_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/spacetime_lattice.py#L263-L288"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.ancilla_mass_index" title="Link to this definition">#</a></dt>
<dd><p>Get the index of the qubit used as the mass measurement ancilla.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The index of the mass measurement qubit.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[int]</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the mass measurement qubit is toggled off.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.ancilla_comparator_index">
<span class="sig-name descname"><span class="pre">ancilla_comparator_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/spacetime_lattice.py#L290-L341"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.ancilla_comparator_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used as comparator ancillae for the specified index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – The index for which to retrieve the comparator qubit indices, by default <code class="docutils literal notranslate"><span class="pre">None</span></code>.
There are <cite>num_dims-1</cite> available indices (i.e., 1 for 2D and 2 for 3D).
When <cite>index</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the indices of ancillae qubits for all dimensions are returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of indices of the qubits used as obstacle ancilla for the given dimension.
By convention, the 0th qubit in the returned list is used
for lower bound comparison and the 1st is used for upper bound comparisons.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the dimension does not exist or if the lattice is set up such that it contains no ancilla qubits for volumetric operations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.volumetric_ancilla_qubit_combinations">
<span class="sig-name descname"><span class="pre">volumetric_ancilla_qubit_combinations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">overflow_occurred</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/spacetime_lattice.py#L343-L390"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.volumetric_ancilla_qubit_combinations" title="Link to this definition">#</a></dt>
<dd><p>Get all combinations of ancilla qubit indices required for volumetric operations.</p>
<p>Volumetric operations perform actions on contiguous volumes of space in the lattice.
These volumes are defined by lower and upper bounds in each dimension.
Since the locality of the data structure may be affected by periodic boundary conditions,
volumetrics must be adjusted to account for all possible overflow scenarios.
This is done by performing the operations in different orders on the adjusted bounds.
This method returns the sequence of ancilla qubit indices required to perform the operations soundly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>overflow_occurred</strong> (<em>List</em><em>[</em><em>bool</em><em>]</em>) – A <span class="math notranslate nohighlight">\(d\)</span>-length list of booleans indicating whether overflow occurred in each dimension.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sequence of ancilla qubit indices required to perform the volumetric operations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[int]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If volumetric operations are not enabled in the lattice.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.get_registers">
<span class="sig-name descname"><span class="pre">get_registers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/spacetime_lattice.py#L392-L394"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.get_registers" title="Link to this definition">#</a></dt>
<dd><p>Generates the registers on which the quantum circuits will be placed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A fixed number of registers according to the lattice specification.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[List[QuantumRegister], …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.is_inside_an_obstacle">
<span class="sig-name descname"><span class="pre">is_inside_an_obstacle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gridpoint</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/spacetime_lattice.py#L396-L413"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.is_inside_an_obstacle" title="Link to this definition">#</a></dt>
<dd><p>Whether a gridpoint is inside the volume of any obstacle in the lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gridpoint</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – The <span class="math notranslate nohighlight">\(d\)</span>-dimensional gridpoint to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the gridpoint is inside any obstacle.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.logger_name">
<span class="sig-name descname"><span class="pre">logger_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/spacetime_lattice.py#L415-L422"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.logger_name" title="Link to this definition">#</a></dt>
<dd><p>An identifiable name to be used in the logger to help with benchmarking and analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string that can be used to sufficiently identify the lattice specification.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.comparator_periodic_volume_bounds">
<span class="sig-name descname"><span class="pre">comparator_periodic_volume_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/spacetime_lattice.py#L424-L470"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.comparator_periodic_volume_bounds" title="Link to this definition">#</a></dt>
<dd><p>Computes the lower and upper bounds for the <a class="reference internal" href="comps_cqlbm.html#qlbm.components.ms.primitives.Comparator" title="qlbm.components.ms.primitives.Comparator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Comparator</span></code></a>s used to perform volumetric operations in the <a class="reference internal" href="comps_lga.html#qlbm.components.spacetime.spacetime.SpaceTimeQLBM" title="qlbm.components.spacetime.spacetime.SpaceTimeQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeQLBM</span></code></a>.</p>
<p>For any given lower and upper bounds in 1, 2, or 3 dimensions,
modulo operations are applied that detect whether periodic boundary conditions
are required.
If that is the case, the directions in which the bounds overflow
becomes the opposite kind of bound.
For instance, a <span class="math notranslate nohighlight">\(-2 \leq x \leq 7\)</span> interval that would require
a <span class="math notranslate nohighlight">\(-2 \leq x \leq 7\)</span> on a <span class="math notranslate nohighlight">\(16 \\times 16\)</span> would require a <span class="math notranslate nohighlight">\(\geq 2\)</span> comparator
and a <span class="math notranslate nohighlight">\(\leq 7\)</span> comparator.
Since <span class="math notranslate nohighlight">\(-2\)</span> is not part of the domain, it gets mapped to <span class="math notranslate nohighlight">\(14\)</span>,
and a different operation, based on two <span class="math notranslate nohighlight">\(\geq\)</span> comparators is required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bounds</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – The absolute bounds of the volume in each dimensions.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The bounds adjusted for periodicity and whether overflow occurs for each bound.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Tuple[Tuple[int, int], Tuple[bool, bool]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.has_multiple_geometries">
<span class="sig-name descname"><span class="pre">has_multiple_geometries</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/spacetime_lattice.py#L473-L475"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.has_multiple_geometries" title="Link to this definition">#</a></dt>
<dd><p>Whether multiple lattice geometries are simulated simultaneously.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether multiple lattice geometries are simulated simultaneously.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.lattices.lqlga_lattice.</span></span><span class="sig-name descname"><span class="pre">LQLGALattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger=&lt;Logger</span> <span class="pre">qlbm</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L21-L449"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice" title="Link to this definition">#</a></dt>
<dd><p>Lattice class for the <a class="reference internal" href="comps_lga.html#qlbm.components.LQLGA" title="qlbm.components.LQLGA"><code class="xref py py-class docutils literal notranslate"><span class="pre">LQLGA</span></code></a> algorithm.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Summary</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_gridpoints" title="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_gridpoints"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_gridpoints</span></code></a></p></td>
<td><p>The number of gridpoints in each dimension of the lattice.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_velocities</span></code></p></td>
<td><p>The number of discrete velocities in each dimension of the lattice.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_dims</span></code></p></td>
<td><p>The number of dimensions of the lattice.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.discretization" title="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.discretization"><code class="xref py py-attr docutils literal notranslate"><span class="pre">discretization</span></code></a></p></td>
<td><p>The discretization of the lattice.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_velocities_per_point</span></code></p></td>
<td><p>The number of discrete velocities per gridpoint.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_base_qubits" title="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_base_qubits"><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_base_qubits</span></code></a></p></td>
<td><p>The number of qubits required to represent the lattice without velocities.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_total_qubits</span></code></p></td>
<td><p>The total number of qubits required to represent the lattice, including velocities.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">registers</span></code></p></td>
<td><p>The list of quantum registers for the lattice, one for each gridpoint.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">circuit</span></code></p></td>
<td><p>The quantum circuit representing the lattice, initialized with the registers.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The registers encoded in the lattice and their accessors are given below.
For the size of each register,
and <span class="math notranslate nohighlight">\(d\)</span> is the total number of dimensions: 2 or 3.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id13">
<caption><span class="caption-text">Register allocation</span><a class="headerlink" href="#id13" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Register</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Access Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_register" title="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_register"><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocity_register</span></code></a></p></td>
<td><p><span class="math notranslate nohighlight">\(N_g \cdot q\)</span></p></td>
<td><p><a class="reference internal" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_index_flat" title="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_index_flat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">velocity_index_flat()</span></code></a> and <cite>:meth:`velocity_index_tuple</cite></p></td>
<td><p><span class="math notranslate nohighlight">\(N_g\)</span> registers sized according to the number of discrete velocities of the lattice.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logger</strong> (<em>Logger</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_register">
<span class="sig-name descname"><span class="pre">velocity_register</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumRegister</span></code></em><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_register" title="Link to this definition">#</a></dt>
<dd><p>The quantum register representing the velocities of the lattice.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_gridpoints">
<span class="sig-name descname"><span class="pre">num_gridpoints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_gridpoints" title="Link to this definition">#</a></dt>
<dd><p>The number of gridpoints in each dimension of the lattice.
<strong>Important</strong> : for easier compatibility with binary arithmetic, the number of gridpoints
specified in the input dictionary is one larger than the one held in the <code class="docutils literal notranslate"><span class="pre">Lattice</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.shapes">
<span class="sig-name descname"><span class="pre">shapes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><a class="reference internal" href="comps_base.html#qlbm.lattice.geometry.shapes.base.Shape" title="qlbm.lattice.geometry.shapes.base.Shape"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shape</span></code></a><span class="pre">]]</span></em><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.shapes" title="Link to this definition">#</a></dt>
<dd><p>The shapes of the lattice, which are used to define the geometry of the lattice.
The key consists of the type of the shape and the name of the shape, e.g. “bounceback” or “specular”.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.discretization">
<span class="sig-name descname"><span class="pre">discretization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="comps_lga.html#qlbm.lattice.spacetime.properties_base.LatticeDiscretization" title="qlbm.lattice.spacetime.properties_base.LatticeDiscretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">LatticeDiscretization</span></code></a></em><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.discretization" title="Link to this definition">#</a></dt>
<dd><p>The discretization of the lattice, one of <a class="reference internal" href="comps_lga.html#qlbm.lattice.spacetime.properties_base.LatticeDiscretization" title="qlbm.lattice.spacetime.properties_base.LatticeDiscretization"><code class="xref py py-class docutils literal notranslate"><span class="pre">LatticeDiscretization</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_base_qubits">
<span class="sig-name descname"><span class="pre">num_base_qubits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_base_qubits" title="Link to this definition">#</a></dt>
<dd><p>The number of qubits required to represent the lattice.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_marker_qubits">
<span class="sig-name descname"><span class="pre">num_marker_qubits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_marker_qubits" title="Link to this definition">#</a></dt>
<dd><p>The number of qubits used to identify geometries, if parallel lattices are being simulated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.get_registers">
<span class="sig-name descname"><span class="pre">get_registers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L122-L151"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.get_registers" title="Link to this definition">#</a></dt>
<dd><p>Generates the registers on which the quantum circuits will be placed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A fixed number of registers according to the lattice specification.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[List[QuantumRegister], …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.gridpoint_index_tuple">
<span class="sig-name descname"><span class="pre">gridpoint_index_tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gridpoint</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L153-L191"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.gridpoint_index_tuple" title="Link to this definition">#</a></dt>
<dd><p>Get the lexicographic index of a gridpoint in the lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gridpoint</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – The gridpoint formatted as a tuple of indices for each dimension.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lexicographic index of the gridpoint in the lattice.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the gridpoint index is out of bounds for the lattice.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.gridpoint_index_flat">
<span class="sig-name descname"><span class="pre">gridpoint_index_flat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gridpoint</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L193-L223"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.gridpoint_index_flat" title="Link to this definition">#</a></dt>
<dd><p>Get the tuple representation of a gridpoint index in the lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gridpoint</strong> (<em>int</em>) – The lexicographic index of the gridpoint in the lattice.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The tuple representation of the gridpoint index in the lattice.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[int, …]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the gridpoint index is out of bounds for the lattice.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_index_flat">
<span class="sig-name descname"><span class="pre">velocity_index_flat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gridpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L225-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_index_flat" title="Link to this definition">#</a></dt>
<dd><p>Get the index of a qubit representing a particular velocity channel of a given gridpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gridpoint</strong> (<em>int</em>) – The lexicographic index of the gridpoint in the lattice.</p></li>
<li><p><strong>velocity</strong> (<em>int</em>) – The index of the velocity channel (0-indexed).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The index of the qubit representing the velocity channel at the specified gridpoint.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the gridpoint or velocity indices are out of bounds for the lattice.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_index_tuple">
<span class="sig-name descname"><span class="pre">velocity_index_tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gridpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L260-L288"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_index_tuple" title="Link to this definition">#</a></dt>
<dd><p>Get the index of a qubit representing a particular velocity channel of a given gridpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gridpoint</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – The gridpoint formatted as a tuple of indices for each dimension.</p></li>
<li><p><strong>velocity</strong> (<em>int</em>) – The index of the velocity channel (0-indexed).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The index of the qubit representing the velocity channel at the specified gridpoint.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the gridpoint or velocity indices are out of bounds for the lattice.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.marker_index">
<span class="sig-name descname"><span class="pre">marker_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L290-L303"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.marker_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits addressing the marker.</p>
<p>This is only useful if multiple lattice geometries are addressed simultaneously.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The absolute indices of the marker qubits.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.get_velocity_qubits_of_line">
<span class="sig-name descname"><span class="pre">get_velocity_qubits_of_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line_index</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L305-L332"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.get_velocity_qubits_of_line" title="Link to this definition">#</a></dt>
<dd><p>Returns the velocity qubits of the positive and negative directions of a streaming line.</p>
<p>Assumes that the lattice follows a <span class="math notranslate nohighlight">\(D_{d}Q_{q}\)</span> discretization, where if <span class="math notranslate nohighlight">\(q\)</span> is even, there are
<span class="math notranslate nohighlight">\(\lceil \frac{q}{2} \rceil\)</span> streaming lines. This is to be generalized in the future.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>line_index</strong> (<em>int</em>) – The index of the line to get the velocity qubits for. Counted from 0 according to the regular discretization taxonomy.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of velocity qubits for the specified line.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.logger_name">
<span class="sig-name descname"><span class="pre">logger_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L334-L341"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.logger_name" title="Link to this definition">#</a></dt>
<dd><p>An identifiable name to be used in the logger to help with benchmarking and analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string that can be used to sufficiently identify the lattice specification.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.set_geometries">
<span class="sig-name descname"><span class="pre">set_geometries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometries</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L343-L385"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.set_geometries" title="Link to this definition">#</a></dt>
<dd><p>Updates the geometry setup of the lattice.</p>
<p>For a given lattice (set number of gridpoints and velocity discretization),
set multiple geometry configurations to simulate simultaneously.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qlbm.lattice</span><span class="w"> </span><span class="kn">import</span> <span class="n">LQLGALattice</span>

<span class="n">lattice</span> <span class="o">=</span> <span class="n">LQLGALattice</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;lattice&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;dim&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
            <span class="s2">&quot;velocities&quot;</span><span class="p">:</span> <span class="s2">&quot;D1Q2&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">lattice</span><span class="o">.</span><span class="n">set_geometries</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[{</span><span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="s2">&quot;cuboid&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;boundary&quot;</span><span class="p">:</span> <span class="s2">&quot;bounceback&quot;</span><span class="p">}],</span>
        <span class="p">[{</span><span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="s2">&quot;cuboid&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;boundary&quot;</span><span class="p">:</span> <span class="s2">&quot;specular&quot;</span><span class="p">}],</span>
        <span class="p">[{</span><span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="s2">&quot;cuboid&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;boundary&quot;</span><span class="p">:</span> <span class="s2">&quot;specular&quot;</span><span class="p">}],</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">lattice</span><span class="o">.</span><span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/e70dd8b599050e83d2ccf96390fbe8d0/lattice-5.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/843747708316f701b153ca677dfa2a6c/lattice-5.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/a2009bed02048c21f4d54184a90df694/lattice-5.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/9ff08652c2459fdea4596da9c8b4e4a3/lattice-5.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/lattice-5.png" class="plot-directive" src="../_images/lattice-5.png" />
</figure>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>geometries</strong> (<em>Dict</em>) – A list of geometries to simulate on the same lattice.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.has_multiple_geometries">
<span class="sig-name descname"><span class="pre">has_multiple_geometries</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L387-L389"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.has_multiple_geometries" title="Link to this definition">#</a></dt>
<dd><p>Whether multiple lattice geometries are simulated simultaneously.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether multiple lattice geometries are simulated simultaneously.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.has_accumulation_register">
<span class="sig-name descname"><span class="pre">has_accumulation_register</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L391-L400"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.has_accumulation_register" title="Link to this definition">#</a></dt>
<dd><p>Whether the lattice has a register that accumulates quantities at each step.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether the lattice has a register that accumulates quantities at each step.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.use_accumulation_register">
<span class="sig-name descname"><span class="pre">use_accumulation_register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_to_accumulate</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L402-L431"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.use_accumulation_register" title="Link to this definition">#</a></dt>
<dd><p>Sets up the accumulation register of the lattice.</p>
<p>This register has a weighted value added to it at the end of each time step.
The value is a linear combination of the occupancy of several velocity channels.
This in turn allows for time-averaged calculations for values related to pressure,
mass, or drag/lift coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em>) – The size of the register that accumulates the value.</p></li>
<li><p><strong>indices_to_accumulate</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – The qubit indices that contribute to the accumulated value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.accumulation_index">
<span class="sig-name descname"><span class="pre">accumulation_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/lattices/lqlga_lattice.py#L433-L449"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.accumulation_index" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the qubits used for the accumulation register.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The absolute indices of the accumulation qubits.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="geometry">
<span id="id8"></span><h2>Geometry<a class="headerlink" href="#geometry" title="Link to this heading">#</a></h2>
<p>Processing obstacle geometry into quantum circuits is a tedious and error-prone task when performed manually.
To alleviate this challenge, <code class="docutils literal notranslate"><span class="pre">qlbm</span></code> provides <a class="reference internal" href="#qlbm.lattice.geometry.Block" title="qlbm.lattice.geometry.Block"><code class="xref py py-class docutils literal notranslate"><span class="pre">Block</span></code></a> and <a class="reference internal" href="#qlbm.lattice.geometry.Circle" title="qlbm.lattice.geometry.Circle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Circle</span></code></a> classes that
parse the geometry information supplied as part of the <a class="reference internal" href="comps_base.html#qlbm.lattice.lattices.base.Lattice" title="qlbm.lattice.lattices.base.Lattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lattice</span></code></a> specification
into information that parameterized the construction of quantum circuits.
This includes the position of the obstacle within the grid and its boundary conditions.
In addition, these shapes contain triangulation methods that
allow them to be exported as <code class="docutils literal notranslate"><span class="pre">stl</span></code> files and visualized in Paraview.</p>
<p>Each shape contains snippets of information that determine how
individual components of reflection behave.
To make the generation of this circuits more manageable, we
segment the block information into different categories of edge cases, which are also broken down by algorithm.</p>
<p>The <a class="reference internal" href="comps_cqlbm.html#qlbm.components.CQLBM" title="qlbm.components.CQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">CQLBM</span></code></a> algorithm uses the following data structures:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#qlbm.lattice.geometry.DimensionalReflectionData" title="qlbm.lattice.geometry.DimensionalReflectionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">DimensionalReflectionData</span></code></a> models the isolated, one-dimensional features of a fixed point on the grid.</p></li>
<li><p><a class="reference internal" href="#qlbm.lattice.geometry.ReflectionPoint" title="qlbm.lattice.geometry.ReflectionPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflectionPoint</span></code></a> models the 2D or 3D information of a fixed point in space.</p></li>
<li><p><a class="reference internal" href="#qlbm.lattice.geometry.ReflectionWall" title="qlbm.lattice.geometry.ReflectionWall"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflectionWall</span></code></a> models the 2D or 3D information of the wall of the obstacle.</p></li>
<li><p><a class="reference internal" href="#qlbm.lattice.geometry.ReflectionResetEdge" title="qlbm.lattice.geometry.ReflectionResetEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflectionResetEdge</span></code></a> models the 3D information of an edge along the walls of an obstacle.</p></li>
</ol>
<p>The <a class="reference internal" href="comps_lga.html#qlbm.components.spacetime.spacetime.SpaceTimeQLBM" title="qlbm.components.spacetime.spacetime.SpaceTimeQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeQLBM</span></code></a> algorithm on makes use of the following:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#qlbm.lattice.geometry.SpaceTimePWReflectionData" title="qlbm.lattice.geometry.SpaceTimePWReflectionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimePWReflectionData</span></code></a> models the reflection data of a single grid point of the lattice.</p></li>
<li><p><a class="reference internal" href="#qlbm.lattice.geometry.SpaceTimeVolumetricReflectionData" title="qlbm.lattice.geometry.SpaceTimeVolumetricReflectionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeVolumetricReflectionData</span></code></a> models the reflection data of a contiguous volume in space.</p></li>
<li><p><a class="reference internal" href="#qlbm.lattice.geometry.SpaceTimeDiagonalReflectionData" title="qlbm.lattice.geometry.SpaceTimeDiagonalReflectionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeDiagonalReflectionData</span></code></a> of diagonals in 2D.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="comps_cqlbm.html#qlbm.components.CQLBM" title="qlbm.components.CQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">CQLBM</span></code></a> and <a class="reference internal" href="comps_lga.html#qlbm.components.spacetime.spacetime.SpaceTimeQLBM" title="qlbm.components.spacetime.spacetime.SpaceTimeQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeQLBM</span></code></a> support different kinds of geometry.
For <a class="reference internal" href="comps_cqlbm.html#qlbm.components.CQLBM" title="qlbm.components.CQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">CQLBM</span></code></a>, geometry objects can only be 2D or 3D cuboids, and they must be placed
at least two grid points apart for consistent behavior.
<a class="reference internal" href="comps_lga.html#qlbm.components.spacetime.spacetime.SpaceTimeQLBM" title="qlbm.components.spacetime.spacetime.SpaceTimeQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeQLBM</span></code></a> supports 2D rectangles of arbitrary lengths, as well as circles.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.geometry.</span></span><span class="sig-name descname"><span class="pre">Block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_grid_qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_condition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gridpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L30-L936"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block" title="Link to this definition">#</a></dt>
<dd><p>Contains information required for the generation of boundary conditions for an axis-parallel cuboid obstacle.</p>
<p>Available for the specular reflection and bounce-back for the <a class="reference internal" href="comps_cqlbm.html#qlbm.components.CQLBM" title="qlbm.components.CQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">CQLBM</span></code></a> algorithm and bounce-back for the <code class="xref py py-class docutils literal notranslate"><span class="pre">STQBM</span></code> algorithm.
A block can be constructed from minimal information, see the Table below.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id14">
<caption><span class="caption-text">Constructor parameters</span><a class="headerlink" href="#id14" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">bounds</span></code></p></td>
<td><p>A <code class="docutils literal notranslate"><span class="pre">List[Tuple[int,</span> <span class="pre">int]]</span></code> of lower and upper bounds in each dimension. For example, <code class="docutils literal notranslate"><span class="pre">[(2,</span> <span class="pre">5),</span> <span class="pre">(10,</span> <span class="pre">12)]</span></code>; <code class="docutils literal notranslate"><span class="pre">[(2,</span> <span class="pre">5),</span> <span class="pre">(9,</span> <span class="pre">12),</span> <span class="pre">(33,</span> <span class="pre">70)]</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_qubits</span></code></p></td>
<td><p>The number of grid qubits of the underlying lattice.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">boundary_condition</span></code></p></td>
<td><p>A string indicating the type of boundary condition of the block. Should be either <code class="docutils literal notranslate"><span class="pre">&quot;specular&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;bounceback&quot;</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The <a class="reference internal" href="#qlbm.lattice.geometry.Block" title="qlbm.lattice.geometry.Block"><code class="xref py py-class docutils literal notranslate"><span class="pre">Block</span></code></a> constructor will parse this information and automatically infer all of the information
required to perform all of the reflection edge cases.
This data is split over several attributes, see the table below.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id15">
<caption><span class="caption-text">Class attributes</span><a class="headerlink" href="#id15" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">bounds</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[Tuple[int,</span> <span class="pre">int]]</span></code> of lower and upper bounds in each dimension. For example, <code class="docutils literal notranslate"><span class="pre">[(2,</span> <span class="pre">5),</span> <span class="pre">(10,</span> <span class="pre">12)]</span></code>; <code class="docutils literal notranslate"><span class="pre">[(2,</span> <span class="pre">5),</span> <span class="pre">(9,</span> <span class="pre">12),</span> <span class="pre">(33,</span> <span class="pre">70)]</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">inside_points_data</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[Tuple[DimensionalReflectionData,</span> <span class="pre">...]]</span></code> data encoding the corner points on the <cite>inside</cite> of the obstacle. The outer list contains <span class="math notranslate nohighlight">\(d\)</span> entries, one per dimension. Each entry is a tuple of <a class="reference internal" href="#qlbm.lattice.geometry.DimensionalReflectionData" title="qlbm.lattice.geometry.DimensionalReflectionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">DimensionalReflectionData</span></code></a> of the lower and upper bounds of that dimension, respectively.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">outside_points_data</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[Tuple[DimensionalReflectionData,</span> <span class="pre">...]]</span></code> data encoding the corner points on the <cite>outside</cite> of the obstacle. The outer list contains <span class="math notranslate nohighlight">\(d\)</span> entries, one per dimension. Each entry is a tuple of <a class="reference internal" href="#qlbm.lattice.geometry.DimensionalReflectionData" title="qlbm.lattice.geometry.DimensionalReflectionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">DimensionalReflectionData</span></code></a> of the lower and upper bounds of that dimension, respectively.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">walls_inside</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[List[ReflectionWall,</span> <span class="pre">...]]</span></code> data encoding the walls of the <cite>inside</cite> of the obstacle. The outer list contains <span class="math notranslate nohighlight">\(d\)</span> entries, one per dimension. Each inner list is a list of two <a class="reference internal" href="#qlbm.lattice.geometry.ReflectionWall" title="qlbm.lattice.geometry.ReflectionWall"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflectionWall</span></code></a>s of the lower and upper bounds of that dimension, respectively.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">walls_outside</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[List[ReflectionWall,</span> <span class="pre">...]]</span></code> data encoding the walls of the <cite>outside</cite> of the obstacle. The outer list contains <span class="math notranslate nohighlight">\(d\)</span> entries, one per dimension. Each inner list is a list of two <a class="reference internal" href="#qlbm.lattice.geometry.ReflectionWall" title="qlbm.lattice.geometry.ReflectionWall"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflectionWall</span></code></a>s of the lower and upper bounds of that dimension, respectively.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">corners_inside</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[ReflectionPoint]</span></code> data encoding the corner points on the <cite>inside</cite> of the obstacle. There are 4 inner corner <a class="reference internal" href="#qlbm.lattice.geometry.ReflectionPoint" title="qlbm.lattice.geometry.ReflectionPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflectionPoint</span></code></a>s per obstacle in 2D, and 8 in 3D.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">corners_outside</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[ReflectionPoint]</span></code> data encoding the corner points on the <cite>outside</cite> of the obstacle. There are 4 outer corner <a class="reference internal" href="#qlbm.lattice.geometry.ReflectionPoint" title="qlbm.lattice.geometry.ReflectionPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflectionPoint</span></code></a>s per obstacle in 2D, and 8 in 3D.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">near_corner_points_2d</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[ReflectionPoint]</span></code> data encoding points on the outside of the object that are adjacent to inner corner points. These points require additional logic in the quantum circuit for particles that have streamed without reflecting off the obstacle. Only applicable to 2D example, since 3D example use edges instead. There are 8 near-corner <a class="reference internal" href="#qlbm.lattice.geometry.ReflectionPoint" title="qlbm.lattice.geometry.ReflectionPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflectionPoint</span></code></a> s per obstacle.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">corner_edges_3d</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[ReflectionResetEdge]</span></code> data encoding edges on the outside of the object that are adjacent to corners of the obstacle. Used to reset ancilla qubit states after reflection. There are 12 corner <a class="reference internal" href="#qlbm.lattice.geometry.ReflectionResetEdge" title="qlbm.lattice.geometry.ReflectionResetEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflectionResetEdge</span></code></a> s per obstacle.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">near_corner_edges_3d</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[ReflectionResetEdge]</span></code> data encoding edges on the outside of the object that are adjacent either side of <code class="xref py py-attr docutils literal notranslate"><span class="pre">corner_edges_3d</span></code>. These edges require additional logic in the quantum circuit for particles that have streamed without reflecting off the obstacle. There are 24 near-corner <a class="reference internal" href="#qlbm.lattice.geometry.ReflectionResetEdge" title="qlbm.lattice.geometry.ReflectionResetEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflectionResetEdge</span></code></a> s per obstacle.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">overlapping_near_corner_edge_points_3d</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[ReflectionPoint]</span></code> data encoding the set of points at the intersections of <code class="xref py py-attr docutils literal notranslate"><span class="pre">near_corner_edges_3d</span></code>. These points require additional logic in to account for the fact that the state of obstacle ancilla qubits was doubly reset (once by each edge). There are 24 such <a class="reference internal" href="#qlbm.lattice.geometry.ReflectionPoint" title="qlbm.lattice.geometry.ReflectionPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflectionPoint</span></code></a> s per obstacle.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bounds</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>num_grid_qubits</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>boundary_condition</strong> (<em>str</em>)</p></li>
<li><p><strong>num_gridpoints</strong> (<em>List</em><em>[</em><em>int</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.get_spacetime_reflection_data_d1q2">
<span class="sig-name descname"><span class="pre">get_spacetime_reflection_data_d1q2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L505-L547"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.get_spacetime_reflection_data_d1q2" title="Link to this definition">#</a></dt>
<dd><p>Calculate space-time reflection data for <span class="math notranslate nohighlight">\(D_1Q_2\)</span> <a class="reference internal" href="comps_lga.html#qlbm.components.spacetime.spacetime.SpaceTimeQLBM" title="qlbm.components.spacetime.spacetime.SpaceTimeQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeQLBM</span></code></a> lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>properties</strong> (<em>SpaceTimeLatticeBuilder</em>) – The lattice discretization properties.</p></li>
<li><p><strong>None</strong> (<em>num_steps int</em><em> |</em>) – Number of timesteps to calculate reflections for. If None, uses <code class="docutils literal notranslate"><span class="pre">properties.num_timesteps</span></code>. Defaults to None.</p></li>
<li><p><strong>optional</strong> – Number of timesteps to calculate reflections for. If None, uses <code class="docutils literal notranslate"><span class="pre">properties.num_timesteps</span></code>. Defaults to None.</p></li>
<li><p><strong>num_steps</strong> (<em>int</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information encoding the reflections to be performed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[SpaceTimeReflectionData]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.get_spacetime_reflection_data_d2q4">
<span class="sig-name descname"><span class="pre">get_spacetime_reflection_data_d2q4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L549-L599"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.get_spacetime_reflection_data_d2q4" title="Link to this definition">#</a></dt>
<dd><p>Calculate space-time reflection data for <span class="math notranslate nohighlight">\(D_2Q_4\)</span> <a class="reference internal" href="comps_lga.html#qlbm.components.spacetime.spacetime.SpaceTimeQLBM" title="qlbm.components.spacetime.spacetime.SpaceTimeQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeQLBM</span></code></a> lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>properties</strong> (<em>SpaceTimeLatticeBuilder</em>) – The lattice discretization properties.</p></li>
<li><p><strong>num_steps</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Number of timesteps to calculate reflections for. If None, uses <code class="docutils literal notranslate"><span class="pre">properties.num_timesteps</span></code>. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information encoding the reflections to be performed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[SpaceTimeReflectionData]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.get_d2q4_volumetric_reflection_data">
<span class="sig-name descname"><span class="pre">get_d2q4_volumetric_reflection_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L601-L725"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.get_d2q4_volumetric_reflection_data" title="Link to this definition">#</a></dt>
<dd><p>Calculate volumetric reflection data for <span class="math notranslate nohighlight">\(D_2Q_4\)</span> <a class="reference internal" href="comps_lga.html#qlbm.components.spacetime.spacetime.SpaceTimeQLBM" title="qlbm.components.spacetime.spacetime.SpaceTimeQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeQLBM</span></code></a> lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>properties</strong> (<em>SpaceTimeLatticeBuilder</em>) – The lattice discretization properties.</p></li>
<li><p><strong>None</strong> (<em>num_steps int</em><em> |</em>) – Number of timesteps to calculate reflections for. If None, uses <code class="docutils literal notranslate"><span class="pre">properties.num_timesteps</span></code>. Defaults to None.</p></li>
<li><p><strong>optional</strong> – Number of timesteps to calculate reflections for. If None, uses <code class="docutils literal notranslate"><span class="pre">properties.num_timesteps</span></code>. Defaults to None.</p></li>
<li><p><strong>num_steps</strong> (<em>int</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information encoding the reflections to be performed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#qlbm.lattice.geometry.SpaceTimeVolumetricReflectionData" title="qlbm.lattice.geometry.SpaceTimeVolumetricReflectionData">SpaceTimeVolumetricReflectionData</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.get_d2q4_surfaces">
<span class="sig-name descname"><span class="pre">get_d2q4_surfaces</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L727-L758"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.get_d2q4_surfaces" title="Link to this definition">#</a></dt>
<dd><p>Get all surfaces of the block in 2 dimensions.</p>
<p>The information is formatted as <code class="docutils literal notranslate"><span class="pre">List[List[List[Tuple[int,</span> <span class="pre">...]]]]</span></code>.
The outermost list is by dimension.
The middle list contains two lists pertaining to the lower and upper bounds of the block in that dimenison.
The innermost list contains the gridpoints that make up the surface encoded as tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The block surfaces in two dimensions.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[List[List[Tuple[int, …]]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.get_lbm_wall_velocity_indices_to_reflect">
<span class="sig-name descname"><span class="pre">get_lbm_wall_velocity_indices_to_reflect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discretization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L760-L795"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.get_lbm_wall_velocity_indices_to_reflect" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the velocities that need to be reflected at gridpoints outside the wall of the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>discretization</strong> (<a class="reference internal" href="comps_lga.html#qlbm.lattice.spacetime.properties_base.LatticeDiscretization" title="qlbm.lattice.spacetime.properties_base.LatticeDiscretization"><em>LatticeDiscretization</em></a>) – The discretization of the lattice.</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – The dimension that the wall reflects.</p></li>
<li><p><strong>bounds</strong> (<em>Tuple</em><em>[</em><em>bool</em><em>, </em><em>...</em><em>]</em>) – The bounds of the corner to address.</p></li>
<li><p><strong>bound</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of velocity indices to reflect.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the discretization is not supported or if the dimension or bounds are inconsistent.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.get_lbm_near_corner_velocity_indices_to_reflect">
<span class="sig-name descname"><span class="pre">get_lbm_near_corner_velocity_indices_to_reflect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discretization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L797-L837"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.get_lbm_near_corner_velocity_indices_to_reflect" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the velocities that need to be reflected at gridpoints near the corners of the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>discretization</strong> (<a class="reference internal" href="comps_lga.html#qlbm.lattice.spacetime.properties_base.LatticeDiscretization" title="qlbm.lattice.spacetime.properties_base.LatticeDiscretization"><em>LatticeDiscretization</em></a>) – The discretization of the lattice.</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – The dimension outside of obstacle bounds.</p></li>
<li><p><strong>bounds</strong> (<em>Tuple</em><em>[</em><em>bool</em><em>, </em><em>...</em><em>]</em>) – The bounds of the corner to address.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of velocity indices to reflect.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the discretization is not supported or if the dimension or bounds are inconsistent.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.get_lbm_outside_corner_indices_to_reflect">
<span class="sig-name descname"><span class="pre">get_lbm_outside_corner_indices_to_reflect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discretization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L839-L872"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.get_lbm_outside_corner_indices_to_reflect" title="Link to this definition">#</a></dt>
<dd><p>Get the indices of the velocities that need to be reflected at the outside corners of the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>discretization</strong> (<a class="reference internal" href="comps_lga.html#qlbm.lattice.spacetime.properties_base.LatticeDiscretization" title="qlbm.lattice.spacetime.properties_base.LatticeDiscretization"><em>LatticeDiscretization</em></a>) – The discretization of the lattice.</p></li>
<li><p><strong>bounds</strong> (<em>Tuple</em><em>[</em><em>bool</em><em>, </em><em>...</em><em>]</em>) – The bounds of the corner to address.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of velocity indices to reflect.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="tools.html#qlbm.tools.exceptions.LatticeException" title="qlbm.tools.exceptions.LatticeException"><strong>LatticeException</strong></a> – If the discretization is not supported or if the bounds are inconsistent.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.get_lqlga_reflection_data_d1q2">
<span class="sig-name descname"><span class="pre">get_lqlga_reflection_data_d1q2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L874-L885"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.get_lqlga_reflection_data_d1q2" title="Link to this definition">#</a></dt>
<dd><p>Calculate space-time reflection data for <span class="math notranslate nohighlight">\(D_1Q_2\)</span> <a class="reference internal" href="comps_lga.html#qlbm.components.LQLGA" title="qlbm.components.LQLGA"><code class="xref py py-class docutils literal notranslate"><span class="pre">LQLGA</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.get_lqlga_reflection_data_d1q3">
<span class="sig-name descname"><span class="pre">get_lqlga_reflection_data_d1q3</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L887-L901"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.get_lqlga_reflection_data_d1q3" title="Link to this definition">#</a></dt>
<dd><p>Calculate space-time reflection data for <span class="math notranslate nohighlight">\(D_1Q_3\)</span> <a class="reference internal" href="comps_lga.html#qlbm.components.LQLGA" title="qlbm.components.LQLGA"><code class="xref py py-class docutils literal notranslate"><span class="pre">LQLGA</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.contains_gridpoint">
<span class="sig-name descname"><span class="pre">contains_gridpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gridpoint</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L903-L908"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.contains_gridpoint" title="Link to this definition">#</a></dt>
<dd><p>Whether the block contains a given gridpoint within its volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gridpoint</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – The gridpoint to check for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the gridpoint is within the block.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.stl_mesh">
<span class="sig-name descname"><span class="pre">stl_mesh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L910-L917"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.stl_mesh" title="Link to this definition">#</a></dt>
<dd><p>Provides the <code class="docutils literal notranslate"><span class="pre">stl</span></code> representation of the shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The mesh representing the shape.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">stl.mesh.Mesh</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L919-L921"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.to_json" title="Link to this definition">#</a></dt>
<dd><p>Serializes the shape to JSON format.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The JSON representation of the shape.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L923-L925"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.name" title="Link to this definition">#</a></dt>
<dd><p>The name of the shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The name of the shape.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Block.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L927-L936"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Block.to_dict" title="Link to this definition">#</a></dt>
<dd><p>Produces a dictionary representation of the shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary representation of the bounds and boundary conditions of the shape.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, List[int] | str]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.geometry.</span></span><span class="sig-name descname"><span class="pre">Circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_grid_qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_condition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mesh_segments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L18-L557"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle" title="Link to this definition">#</a></dt>
<dd><p>Contains information required for the generation of bounce-back boundary conditions for the <code class="xref py py-class docutils literal notranslate"><span class="pre">STQBM</span></code> algorithm.</p>
<p>A circle can be constructed from minimal information, see the Table below.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id16">
<caption><span class="caption-text">Constructor parameters</span><a class="headerlink" href="#id16" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">center</span></code></p></td>
<td><p>A <code class="docutils literal notranslate"><span class="pre">Tuple[int,</span> <span class="pre">...]</span></code> specifying the center of the circle. For example, <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">5)</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">radius</span></code></p></td>
<td><p>An <code class="docutils literal notranslate"><span class="pre">int</span></code> specifying the radius of the circle. For example, <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_grid_qubits</span></code></p></td>
<td><p>The number of grid qubits of the underlying lattice.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">boundary_condition</span></code></p></td>
<td><p>A <code class="docutils literal notranslate"><span class="pre">string</span></code> indicating the type of boundary condition of the block. At the moment, only <code class="docutils literal notranslate"><span class="pre">&quot;bounceback&quot;</span></code> is supported.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_mesh_segments</span></code></p></td>
<td><p>An <code class="docutils literal notranslate"><span class="pre">int</span></code> that describes how fine the <code class="docutils literal notranslate"><span class="pre">stl</span></code> of the object is.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The <a class="reference internal" href="#qlbm.lattice.geometry.Circle" title="qlbm.lattice.geometry.Circle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Circle</span></code></a> constructor will parse this information and automatically infer all of the information
required to perform all of the reflection edge cases. Class attributes are described in the table below.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id17">
<caption><span class="caption-text">Class attributes</span><a class="headerlink" href="#id17" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">perimeter_points</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[Tuple[int,</span> <span class="pre">int]]</span></code> of all gridpoints that lie on the perimeter of the circle, and are therefore relevant for boundary conditions.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>radius</strong> (<em>int</em>)</p></li>
<li><p><strong>num_grid_qubits</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>boundary_condition</strong> (<em>str</em>)</p></li>
<li><p><strong>num_mesh_segments</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.get_circle_perimeter">
<span class="sig-name descname"><span class="pre">get_circle_perimeter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L69-L102"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.get_circle_perimeter" title="Link to this definition">#</a></dt>
<dd><p>Uses Bresenham’s circle drawing algorithm to specify all points along the perimeter of the circle.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>All gridpoints that lie on the perimeter of the circle</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[Tuple[int, int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.stl_mesh">
<span class="sig-name descname"><span class="pre">stl_mesh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L104-L127"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.stl_mesh" title="Link to this definition">#</a></dt>
<dd><p>Provides the <code class="docutils literal notranslate"><span class="pre">stl</span></code> representation of the shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The mesh representing the shape.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">stl.mesh.Mesh</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.is_point_on_segment">
<span class="sig-name descname"><span class="pre">is_point_on_segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gridpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segment</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L181-L203"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.is_point_on_segment" title="Link to this definition">#</a></dt>
<dd><p>Whether the point belongs to a given axis-aligned segment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gridpoint</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – The gridpoint to test for.</p></li>
<li><p><strong>segment</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – The segment to test for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the point belongs to a given axis-aligned segment.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.is_point_on_any_segment">
<span class="sig-name descname"><span class="pre">is_point_on_any_segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gridpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segments</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L205-L225"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.is_point_on_any_segment" title="Link to this definition">#</a></dt>
<dd><p>Whether the point belongs to any axis-aligned segment in a given list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gridpoint</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – The gridpoint to test for.</p></li>
<li><p><strong>segments</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em>) – The segments to test for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the point lays on any of the given segments.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.split_perimeter_points">
<span class="sig-name descname"><span class="pre">split_perimeter_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L227-L345"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.split_perimeter_points" title="Link to this definition">#</a></dt>
<dd><p>Splits point on the perimeter of the circle into three categories.</p>
<p>Points belong to either
(1) axis-aligned segments
(2) diagonal segments, or
(3) individual points.</p>
<p>Axis-aligned and diagonal segments are encoded as the two ends of the segment.
Individual points are simply listed by their coordinates.
The results are returned in the order listed previously.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>points</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – The gridpoints on the perimeter of the circle.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The points classified by which category they belong to.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[Tuple[int, int]], List[List[Tuple[int, int]]], List[Tuple[int, int]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L347-L349"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.to_json" title="Link to this definition">#</a></dt>
<dd><p>Serializes the shape to JSON format.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The JSON representation of the shape.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L351-L353"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.name" title="Link to this definition">#</a></dt>
<dd><p>The name of the shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The name of the shape.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L355-L362"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.to_dict" title="Link to this definition">#</a></dt>
<dd><p>Produces a dictionary representation of the shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary representation of the bounds and boundary conditions of the shape.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, List[int] | str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.contains_gridpoint">
<span class="sig-name descname"><span class="pre">contains_gridpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gridpoint</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L364-L370"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.contains_gridpoint" title="Link to this definition">#</a></dt>
<dd><p>Whether the block contains a given gridpoint within its volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gridpoint</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – The gridpoint to check for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the gridpoint is within the block.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.get_spacetime_reflection_data_d1q2">
<span class="sig-name descname"><span class="pre">get_spacetime_reflection_data_d1q2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L372-L374"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.get_spacetime_reflection_data_d1q2" title="Link to this definition">#</a></dt>
<dd><p>Calculate space-time reflection data for <span class="math notranslate nohighlight">\(D_1Q_2\)</span> <a class="reference internal" href="comps_lga.html#qlbm.components.spacetime.spacetime.SpaceTimeQLBM" title="qlbm.components.spacetime.spacetime.SpaceTimeQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeQLBM</span></code></a> lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>properties</strong> (<em>SpaceTimeLatticeBuilder</em>) – The lattice discretization properties.</p></li>
<li><p><strong>None</strong> (<em>num_steps int</em><em> |</em>) – Number of timesteps to calculate reflections for. If None, uses <code class="docutils literal notranslate"><span class="pre">properties.num_timesteps</span></code>. Defaults to None.</p></li>
<li><p><strong>optional</strong> – Number of timesteps to calculate reflections for. If None, uses <code class="docutils literal notranslate"><span class="pre">properties.num_timesteps</span></code>. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information encoding the reflections to be performed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[SpaceTimeReflectionData]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.get_spacetime_reflection_data_d2q4">
<span class="sig-name descname"><span class="pre">get_spacetime_reflection_data_d2q4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L397-L482"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.get_spacetime_reflection_data_d2q4" title="Link to this definition">#</a></dt>
<dd><p>Calculate space-time reflection data for <span class="math notranslate nohighlight">\(D_2Q_4\)</span> <a class="reference internal" href="comps_lga.html#qlbm.components.spacetime.spacetime.SpaceTimeQLBM" title="qlbm.components.spacetime.spacetime.SpaceTimeQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeQLBM</span></code></a> lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>properties</strong> (<em>SpaceTimeLatticeBuilder</em>) – The lattice discretization properties.</p></li>
<li><p><strong>num_steps</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Number of timesteps to calculate reflections for. If None, uses <code class="docutils literal notranslate"><span class="pre">properties.num_timesteps</span></code>. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information encoding the reflections to be performed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[SpaceTimeReflectionData]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.get_d2q4_volumetric_reflection_data">
<span class="sig-name descname"><span class="pre">get_d2q4_volumetric_reflection_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">properties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L484-L486"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.get_d2q4_volumetric_reflection_data" title="Link to this definition">#</a></dt>
<dd><p>Calculate volumetric reflection data for <span class="math notranslate nohighlight">\(D_2Q_4\)</span> <a class="reference internal" href="comps_lga.html#qlbm.components.spacetime.spacetime.SpaceTimeQLBM" title="qlbm.components.spacetime.spacetime.SpaceTimeQLBM"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeQLBM</span></code></a> lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>properties</strong> (<em>SpaceTimeLatticeBuilder</em>) – The lattice discretization properties.</p></li>
<li><p><strong>None</strong> (<em>num_steps int</em><em> |</em>) – Number of timesteps to calculate reflections for. If None, uses <code class="docutils literal notranslate"><span class="pre">properties.num_timesteps</span></code>. Defaults to None.</p></li>
<li><p><strong>optional</strong> – Number of timesteps to calculate reflections for. If None, uses <code class="docutils literal notranslate"><span class="pre">properties.num_timesteps</span></code>. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The information encoding the reflections to be performed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#qlbm.lattice.geometry.SpaceTimeVolumetricReflectionData" title="qlbm.lattice.geometry.SpaceTimeVolumetricReflectionData">SpaceTimeVolumetricReflectionData</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.expand_axis_segments">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expand_axis_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis_segments</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L488-L521"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.expand_axis_segments" title="Link to this definition">#</a></dt>
<dd><p>Expands axis-aligned segments encoded as the two extremes of the segment into lists of all points contained within each segment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axis_segments</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em>) – The segments to expand.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All points within each segment.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Tuple[int, int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.Circle.expand_diagonal_segments">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expand_diagonal_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diagonal_segments</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L523-L557"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.Circle.expand_diagonal_segments" title="Link to this definition">#</a></dt>
<dd><p>Expands diagonal segments encoded as the two extremes of the segment into lists of all points contained within each segment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>diagonal_segments</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em>) – The diagonal segments to expand</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All points within each segment.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Tuple[int, …]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.DimensionalReflectionData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.geometry.</span></span><span class="sig-name descname"><span class="pre">DimensionalReflectionData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qubits_to_invert</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_outside_obstacle_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridpoint_encoded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L8-L66"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.DimensionalReflectionData" title="Link to this definition">#</a></dt>
<dd><p>Contains one-dimensional information about the position of a grid point relevant to the obstacle.</p>
<p>Used for edge cases relating to either inside or outside corner points.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id18">
<caption><span class="caption-text">Class attributes</span><a class="headerlink" href="#id18" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">qubits_to_invert</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[int]</span></code> of qubit indices that should be inverted in order to convert the state of grid qubits encoding this dimension to <span class="math notranslate nohighlight">\(\ket{1}^{\otimes n_{g_d}}\)</span>. See the example below.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">bound_type</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">bool</span></code> indicating the type of bound this point belongs to. <code class="docutils literal notranslate"><span class="pre">False</span></code> indicates a lower bound, and <code class="docutils literal notranslate"><span class="pre">True</span></code> indicates an upper bound.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">is_outside_obstacle_bounds</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">bool</span></code> indicating the whether the point belongs to the solid domain. <code class="docutils literal notranslate"><span class="pre">False</span></code> that the point is inside the solid domain, and <code class="docutils literal notranslate"><span class="pre">True</span></code> indicates the outside.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">dim</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">int</span></code> indicating which dimension this object refers to.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">gridpoint_encoded</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">int</span></code> indicating which grid point this object encodes. Used for debugging purposes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code></p></td>
<td><p>A string assigned to each dimensional data object in the <a class="reference internal" href="#qlbm.lattice.geometry.Block" title="qlbm.lattice.geometry.Block"><code class="xref py py-class docutils literal notranslate"><span class="pre">Block</span></code></a> constructor. Used for debugging purposes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Consider for example encoding the grid point at location 2
(encoded as <span class="math notranslate nohighlight">\(\ket{010}\)</span>) on the <span class="math notranslate nohighlight">\(x\)</span>-axis on an <span class="math notranslate nohighlight">\(8\\times 8\)</span> 2D grid.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DimensionalReflectionData</span></code> object encoding this information
would have a <code class="docutils literal notranslate"><span class="pre">qubits_to_invert</span></code> value of <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">2]</span></code>.
This means that the <span class="math notranslate nohighlight">\(0^{th}\)</span> and <span class="math notranslate nohighlight">\(2^{nd}\)</span> qubits
would have to be inverted to produce the <span class="math notranslate nohighlight">\(\ket{111}\)</span> state.
This information is passed on to the reflection operators,
which place the <span class="math notranslate nohighlight">\(X\)</span> gates at the appropriate positions in the register,
and can then use the <span class="math notranslate nohighlight">\(g_x\)</span> register to control reflection.</p>
<p>If we wanted to encode point <span class="math notranslate nohighlight">\(3\)</span> (<span class="math notranslate nohighlight">\(\ket{011}\)</span>) on <span class="math notranslate nohighlight">\(y\)</span>-axis on the same grid,
this would result in <code class="docutils literal notranslate"><span class="pre">qubits_to_invert</span> <span class="pre">=</span> <span class="pre">[5]</span></code>, since the most significant qubit (index 2 of the <span class="math notranslate nohighlight">\(y\)</span>-axis)
is encoded last in the register, and there are 3 qubits encoding the <span class="math notranslate nohighlight">\(x\)</span>-axis “in front” of it.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qubits_to_invert</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>bound_type</strong> (<em>bool</em>)</p></li>
<li><p><strong>is_outside_obstacle_bounds</strong> (<em>bool</em>)</p></li>
<li><p><strong>gridpoint_encoded</strong> (<em>int</em>)</p></li>
<li><p><strong>dim</strong> (<em>int</em>)</p></li>
<li><p><strong>name</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.ReflectionPoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.geometry.</span></span><span class="sig-name descname"><span class="pre">ReflectionPoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_inside</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_outside</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inversion_function</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L148-L197"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.ReflectionPoint" title="Link to this definition">#</a></dt>
<dd><p>Encodes the information required to perform reflection on a single point.</p>
<p>A point is encoded as 2 or 3 fixed <a class="reference internal" href="#qlbm.lattice.geometry.DimensionalReflectionData" title="qlbm.lattice.geometry.DimensionalReflectionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">DimensionalReflectionData</span></code></a> objects, one per dimension.
This classes processes the information encoded in the reflection data
objects into boolean valued attributes that determine
whether the directional velocity qubits should be inverted to perform reflection.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id19">
<caption><span class="caption-text">Class attributes</span><a class="headerlink" href="#id19" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[DimensionalReflectionData]</span></code> containing the point data for each dimension.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">num_dims</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">int</span></code> number of dimensions of this point (also of the corresponding lattice).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">dims_inside</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[int]</span></code> that specifies which of the <code class="docutils literal notranslate"><span class="pre">data</span></code> entries are <cite>inside</cite> obstacle bounds in their respective dimension.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">dims_outside</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[int]</span></code> that specifies which of the <code class="docutils literal notranslate"><span class="pre">data</span></code> entries are <cite>outside</cite> obstacle bounds in their respective dimension.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">qubits_to_invert</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[int]</span></code> of qubit indices that should be inverted in order to convert the state of grid qubits to <span class="math notranslate nohighlight">\(\ket{1}^{\otimes n_{g_d}}\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">inversion_function</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Callable[[List[DimensionalReflectionData]],</span> <span class="pre">List[bool]]</span></code> function that converts the input data into a list of booleans that determine whether the directional velocity qubits should be inverted, per dimensions.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">invert_velocity_in_dimension</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[bool]</span></code> obtained by calling the <code class="docutils literal notranslate"><span class="pre">inversion_function</span></code> on the <code class="docutils literal notranslate"><span class="pre">data</span></code>, indicating whether the directional velocity qubits should be inverted, per dimensions.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">is_near_corner_point</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">bool</span></code> indicating whether the point is a near-corner point (used in 2D reflection).</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>List</em><em>[</em><a class="reference internal" href="#qlbm.lattice.geometry.DimensionalReflectionData" title="qlbm.lattice.geometry.encodings.ms.DimensionalReflectionData"><em>DimensionalReflectionData</em></a><em>]</em>)</p></li>
<li><p><strong>dims_inside</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>dims_outside</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>inversion_function</strong> (<em>Callable</em><em>[</em><em>[</em><em>List</em><em>[</em><a class="reference internal" href="#qlbm.lattice.geometry.DimensionalReflectionData" title="qlbm.lattice.geometry.encodings.ms.DimensionalReflectionData"><em>DimensionalReflectionData</em></a><em>]</em><em>]</em><em>, </em><em>List</em><em>[</em><em>bool</em><em>]</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.ReflectionWall">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.geometry.</span></span><span class="sig-name descname"><span class="pre">ReflectionWall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reflection_data</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L200-L256"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.ReflectionWall" title="Link to this definition">#</a></dt>
<dd><p>Encodes the information required to perform reflection on a wall.</p>
<p>Each wall is encoded as fixed over one dimensions and spanning one or two <cite>alignment</cite> dimensions.
This in turn models which qubits are used for the comparator operations of the reflection operators.
The information required for the alignment dimensions only consists of bounds,
while the fixed dimension uses its <a class="reference internal" href="#qlbm.lattice.geometry.DimensionalReflectionData" title="qlbm.lattice.geometry.DimensionalReflectionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">DimensionalReflectionData</span></code></a> representation.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id20">
<caption><span class="caption-text">Class attributes</span><a class="headerlink" href="#id20" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">lower_bounds</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[int]</span></code> of lower bounds for each dimension.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">upper_bounds</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[int]</span></code> of upper bounds for each dimension.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">DimensionalReflectionData</span></code> of the fixed dimension.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">dim</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">int</span></code> indicating the fixed dimension.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">alignment_dims</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[int]</span></code> indicating the one or two alignment dimensions.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">bounceback_loose_bounds</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[List[bool]]</span></code> indicating whether the comparators should span the dimensions using tight (i.e., <span class="math notranslate nohighlight">\(&lt;\)</span>) or loose (i.e., <span class="math notranslate nohighlight">\(\leq\)</span>) bounds.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>)</p></li>
<li><p><strong>lower_bounds</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>upper_bounds</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>reflection_data</strong> (<a class="reference internal" href="#qlbm.lattice.geometry.DimensionalReflectionData" title="qlbm.lattice.geometry.encodings.ms.DimensionalReflectionData"><em>DimensionalReflectionData</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.ReflectionResetEdge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.geometry.</span></span><span class="sig-name descname"><span class="pre">ReflectionResetEdge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">walls_joining</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims_of_edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_disconnected_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension_outside</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L69-L145"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.ReflectionResetEdge" title="Link to this definition">#</a></dt>
<dd><p>Encodes the information required to perform reflection on an edge in 3D.</p>
<p>An edge is encoded as 2 fixed points as <a class="reference internal" href="#qlbm.lattice.geometry.DimensionalReflectionData" title="qlbm.lattice.geometry.DimensionalReflectionData"><code class="xref py py-class docutils literal notranslate"><span class="pre">DimensionalReflectionData</span></code></a> objects, and one spanning dimension.
This classes processes the information encoded in the reflection data
object into boolean valued attributes that determine
whether the directional velocity qubits should be inverted to perform reflection.</p>
<div class="pst-scrollable-table-container"><table class="table" id="id21">
<caption><span class="caption-text">Class attributes</span><a class="headerlink" href="#id21" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">walls_joining</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[DimensionalReflectionData]</span></code> containing the point data for the two fixed dimensions, stored in ascending order (<span class="math notranslate nohighlight">\(x &lt; y &lt; z\)</span>).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">dims_of_edge</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Tuple[int,</span> <span class="pre">int]</span></code> indicating the fixed dimensions.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">dim_disconnected</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">int</span></code> indicating the dimension the edge spans.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">bounds_disconnected_dim</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">Tuple[int,</span> <span class="pre">int]</span></code> that specifies the bounds of the edge in the dimension that it spans.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">reflected_velocities</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[int]</span></code> that indicates to which dimensions the velocities that this edge affects belong to.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">invert_velocity_in_dimension</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">List[bool]</span></code> indicating whether the directional velocity qubits should be inverted, per dimensions.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">is_corner_edge</span></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">bool</span></code> indicating whether the edge is directly at the corner of the object.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>walls_joining</strong> (<em>List</em><em>[</em><a class="reference internal" href="#qlbm.lattice.geometry.DimensionalReflectionData" title="qlbm.lattice.geometry.encodings.ms.DimensionalReflectionData"><em>DimensionalReflectionData</em></a><em>]</em>)</p></li>
<li><p><strong>dims_of_edge</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>)</p></li>
<li><p><strong>bounds_disconnected_dim</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>)</p></li>
<li><p><strong>dimension_outside</strong> (<em>bool</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.SpaceTimePWReflectionData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.geometry.</span></span><span class="sig-name descname"><span class="pre">SpaceTimePWReflectionData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gridpoint_encoded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubits_to_invert</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_indices_to_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_from_boundary_point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_properties</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L15-L87"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.SpaceTimePWReflectionData" title="Link to this definition">#</a></dt>
<dd><p>Class encoding the necessary information for the reflection of a particle from asingle grid point in the <code class="xref py py-class docutils literal notranslate"><span class="pre">STQBLM</span></code> algorithm.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Summary</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">gridpoint_encoded</span></code></p></td>
<td><p>The gridpoint encoded in the data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">qubits_to_invert</span></code></p></td>
<td><p>The grid qubit indices that have the value <span class="math notranslate nohighlight">\(\ket{0}\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocity_index_to_reflect</span></code></p></td>
<td><p>The index of the qubit encoding the discrete velocity that should be reflected.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">distance_from_boundary_point</span></code></p></td>
<td><p>The distance from the gridpoints where reflection takes place.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">lattice_properties</span></code></p></td>
<td><p>The properties of the lattice in which reflection takes place.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gridpoint_encoded</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>qubits_to_invert</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>velocity_indices_to_reflect</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>distance_from_boundary_point</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>lattice_properties</strong> (<em>SpaceTimeLatticeBuilder</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.SpaceTimeVolumetricReflectionData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.geometry.</span></span><span class="sig-name descname"><span class="pre">SpaceTimeVolumetricReflectionData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fixed_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranged_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_dimension_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_dimension_qubits_to_invert</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_gridpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity_index_to_reflect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_from_boundary_wall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_properties</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L90-L161"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.SpaceTimeVolumetricReflectionData" title="Link to this definition">#</a></dt>
<dd><p>Class encoding the necessary information for the reflection of a volumetric split of particles in the <code class="xref py py-class docutils literal notranslate"><span class="pre">STQBLM</span></code> algorithm.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Summary</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">fixed_dim</span></code></p></td>
<td><p>The physical dimension that the volume does not span.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">ranged_dims</span></code></p></td>
<td><p>The physical dimension(s) that the volume does span.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">range_dimension_bounds</span></code></p></td>
<td><p>The bounds of the volume in each ranged dimension.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">fixed_dimension_qubits_to_invert</span></code></p></td>
<td><p>The grid qubit indices that have the value <span class="math notranslate nohighlight">\(\ket{0}\)</span> for the fixed dimension.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">fixed_gridpoint</span></code></p></td>
<td><p>The numerical value of the fixed gridpoint. Used for debugging purposes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocity_index_to_reflect</span></code></p></td>
<td><p>The index of the qubit encoding the discrete velocity that should be reflected.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">distance_from_boundary_wall</span></code></p></td>
<td><p>The distance from the gridpoints where reflection takes place.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">lattice_properties</span></code></p></td>
<td><p>The properties of the lattice in which reflection takes place.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fixed_dim</strong> (<em>int</em>)</p></li>
<li><p><strong>ranged_dims</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>range_dimension_bounds</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>fixed_dimension_qubits_to_invert</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>fixed_gridpoint</strong> (<em>int</em>)</p></li>
<li><p><strong>velocity_index_to_reflect</strong> (<em>int</em>)</p></li>
<li><p><strong>distance_from_boundary_wall</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>lattice_properties</strong> (<em>SpaceTimeLatticeBuilder</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qlbm.lattice.geometry.SpaceTimeDiagonalReflectionData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">qlbm.lattice.geometry.</span></span><span class="sig-name descname"><span class="pre">SpaceTimeDiagonalReflectionData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_from_boundary_wall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_properties</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/qcfd-lab/qlbm/tree/main/qlbm/lattice/geometry.py#L164-L265"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qlbm.lattice.geometry.SpaceTimeDiagonalReflectionData" title="Link to this definition">#</a></dt>
<dd><p>Class encoding the necessary information for the reflection of a volumetric split of particles in the <code class="xref py py-class docutils literal notranslate"><span class="pre">STQBLM</span></code> algorithm.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Summary</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">fixed_dim</span></code></p></td>
<td><p>The physical dimension that the volume does not span.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">ranged_dims</span></code></p></td>
<td><p>The physical dimension(s) that the volume does span.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">range_dimension_bounds</span></code></p></td>
<td><p>The bounds of the volume in each ranged dimension.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">fixed_dimension_qubits_to_invert</span></code></p></td>
<td><p>The grid qubit indices that have the value <span class="math notranslate nohighlight">\(\ket{0}\)</span> for the fixed dimension.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">fixed_gridpoint</span></code></p></td>
<td><p>The numerical value of the fixed gridpoint. Used for debugging purposes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocity_index_to_reflect</span></code></p></td>
<td><p>The index of the qubit encoding the discrete velocity that should be reflected.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">distance_from_boundary_wall</span></code></p></td>
<td><p>The distance from the gridpoints where reflection takes place.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">lattice_properties</span></code></p></td>
<td><p>The properties of the lattice in which reflection takes place.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bounds</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>step</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>distance_from_boundary_wall</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>lattice_properties</strong> (<em>SpaceTimeLatticeBuilder</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Internal Documentation</p>
      </div>
    </a>
    <a class="right-next"
       href="comps_base.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Base Classes</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lattices">Lattices</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice"><code class="docutils literal notranslate"><span class="pre">MSLattice</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.logger"><code class="docutils literal notranslate"><span class="pre">MSLattice.logger</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.num_dims"><code class="docutils literal notranslate"><span class="pre">MSLattice.num_dims</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.num_gridpoints"><code class="docutils literal notranslate"><span class="pre">MSLattice.num_gridpoints</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.num_velocities"><code class="docutils literal notranslate"><span class="pre">MSLattice.num_velocities</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.num_total_qubits"><code class="docutils literal notranslate"><span class="pre">MSLattice.num_total_qubits</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_velocity_index"><code class="docutils literal notranslate"><span class="pre">MSLattice.ancillae_velocity_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_obstacle_index"><code class="docutils literal notranslate"><span class="pre">MSLattice.ancillae_obstacle_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.ancillae_comparator_index"><code class="docutils literal notranslate"><span class="pre">MSLattice.ancillae_comparator_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.grid_index"><code class="docutils literal notranslate"><span class="pre">MSLattice.grid_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.velocity_index"><code class="docutils literal notranslate"><span class="pre">MSLattice.velocity_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.velocity_dir_index"><code class="docutils literal notranslate"><span class="pre">MSLattice.velocity_dir_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.get_registers"><code class="docutils literal notranslate"><span class="pre">MSLattice.get_registers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.logger_name"><code class="docutils literal notranslate"><span class="pre">MSLattice.logger_name()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.has_multiple_geometries"><code class="docutils literal notranslate"><span class="pre">MSLattice.has_multiple_geometries()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ms_lattice.MSLattice.get_encoding"><code class="docutils literal notranslate"><span class="pre">MSLattice.get_encoding()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice"><code class="docutils literal notranslate"><span class="pre">ABLattice</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.num_gridpoints"><code class="docutils literal notranslate"><span class="pre">ABLattice.num_gridpoints</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.shapes"><code class="docutils literal notranslate"><span class="pre">ABLattice.shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.discretization"><code class="docutils literal notranslate"><span class="pre">ABLattice.discretization</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.num_base_qubits"><code class="docutils literal notranslate"><span class="pre">ABLattice.num_base_qubits</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.registers"><code class="docutils literal notranslate"><span class="pre">ABLattice.registers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.grid_index"><code class="docutils literal notranslate"><span class="pre">ABLattice.grid_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.velocity_index"><code class="docutils literal notranslate"><span class="pre">ABLattice.velocity_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.ancillae_comparator_index"><code class="docutils literal notranslate"><span class="pre">ABLattice.ancillae_comparator_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.ancillae_obstacle_index"><code class="docutils literal notranslate"><span class="pre">ABLattice.ancillae_obstacle_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.get_registers"><code class="docutils literal notranslate"><span class="pre">ABLattice.get_registers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.logger_name"><code class="docutils literal notranslate"><span class="pre">ABLattice.logger_name()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.has_multiple_geometries"><code class="docutils literal notranslate"><span class="pre">ABLattice.has_multiple_geometries()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.ab_lattice.ABLattice.get_encoding"><code class="docutils literal notranslate"><span class="pre">ABLattice.get_encoding()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.oh_lattice.OHLattice"><code class="docutils literal notranslate"><span class="pre">OHLattice</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.num_gridpoints"><code class="docutils literal notranslate"><span class="pre">OHLattice.num_gridpoints</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.shapes"><code class="docutils literal notranslate"><span class="pre">OHLattice.shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.discretization"><code class="docutils literal notranslate"><span class="pre">OHLattice.discretization</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.num_base_qubits"><code class="docutils literal notranslate"><span class="pre">OHLattice.num_base_qubits</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.registers"><code class="docutils literal notranslate"><span class="pre">OHLattice.registers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.get_registers"><code class="docutils literal notranslate"><span class="pre">OHLattice.get_registers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.logger_name"><code class="docutils literal notranslate"><span class="pre">OHLattice.logger_name()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.has_multiple_geometries"><code class="docutils literal notranslate"><span class="pre">OHLattice.has_multiple_geometries()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.oh_lattice.OHLattice.get_encoding"><code class="docutils literal notranslate"><span class="pre">OHLattice.get_encoding()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice"><code class="docutils literal notranslate"><span class="pre">SpaceTimeLattice</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.grid_index"><code class="docutils literal notranslate"><span class="pre">SpaceTimeLattice.grid_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.velocity_index"><code class="docutils literal notranslate"><span class="pre">SpaceTimeLattice.velocity_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.ancilla_mass_index"><code class="docutils literal notranslate"><span class="pre">SpaceTimeLattice.ancilla_mass_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.ancilla_comparator_index"><code class="docutils literal notranslate"><span class="pre">SpaceTimeLattice.ancilla_comparator_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.volumetric_ancilla_qubit_combinations"><code class="docutils literal notranslate"><span class="pre">SpaceTimeLattice.volumetric_ancilla_qubit_combinations()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.get_registers"><code class="docutils literal notranslate"><span class="pre">SpaceTimeLattice.get_registers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.is_inside_an_obstacle"><code class="docutils literal notranslate"><span class="pre">SpaceTimeLattice.is_inside_an_obstacle()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.logger_name"><code class="docutils literal notranslate"><span class="pre">SpaceTimeLattice.logger_name()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.comparator_periodic_volume_bounds"><code class="docutils literal notranslate"><span class="pre">SpaceTimeLattice.comparator_periodic_volume_bounds()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.spacetime_lattice.SpaceTimeLattice.has_multiple_geometries"><code class="docutils literal notranslate"><span class="pre">SpaceTimeLattice.has_multiple_geometries()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice"><code class="docutils literal notranslate"><span class="pre">LQLGALattice</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_register"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.velocity_register</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_gridpoints"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.num_gridpoints</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.shapes"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.discretization"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.discretization</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_base_qubits"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.num_base_qubits</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.num_marker_qubits"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.num_marker_qubits</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.get_registers"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.get_registers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.gridpoint_index_tuple"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.gridpoint_index_tuple()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.gridpoint_index_flat"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.gridpoint_index_flat()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_index_flat"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.velocity_index_flat()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.velocity_index_tuple"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.velocity_index_tuple()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.marker_index"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.marker_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.get_velocity_qubits_of_line"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.get_velocity_qubits_of_line()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.logger_name"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.logger_name()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.set_geometries"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.set_geometries()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.has_multiple_geometries"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.has_multiple_geometries()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.has_accumulation_register"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.has_accumulation_register()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.use_accumulation_register"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.use_accumulation_register()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.lattices.lqlga_lattice.LQLGALattice.accumulation_index"><code class="docutils literal notranslate"><span class="pre">LQLGALattice.accumulation_index()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geometry">Geometry</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block"><code class="docutils literal notranslate"><span class="pre">Block</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.get_spacetime_reflection_data_d1q2"><code class="docutils literal notranslate"><span class="pre">Block.get_spacetime_reflection_data_d1q2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.get_spacetime_reflection_data_d2q4"><code class="docutils literal notranslate"><span class="pre">Block.get_spacetime_reflection_data_d2q4()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.get_d2q4_volumetric_reflection_data"><code class="docutils literal notranslate"><span class="pre">Block.get_d2q4_volumetric_reflection_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.get_d2q4_surfaces"><code class="docutils literal notranslate"><span class="pre">Block.get_d2q4_surfaces()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.get_lbm_wall_velocity_indices_to_reflect"><code class="docutils literal notranslate"><span class="pre">Block.get_lbm_wall_velocity_indices_to_reflect()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.get_lbm_near_corner_velocity_indices_to_reflect"><code class="docutils literal notranslate"><span class="pre">Block.get_lbm_near_corner_velocity_indices_to_reflect()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.get_lbm_outside_corner_indices_to_reflect"><code class="docutils literal notranslate"><span class="pre">Block.get_lbm_outside_corner_indices_to_reflect()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.get_lqlga_reflection_data_d1q2"><code class="docutils literal notranslate"><span class="pre">Block.get_lqlga_reflection_data_d1q2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.get_lqlga_reflection_data_d1q3"><code class="docutils literal notranslate"><span class="pre">Block.get_lqlga_reflection_data_d1q3()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.contains_gridpoint"><code class="docutils literal notranslate"><span class="pre">Block.contains_gridpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.stl_mesh"><code class="docutils literal notranslate"><span class="pre">Block.stl_mesh()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.to_json"><code class="docutils literal notranslate"><span class="pre">Block.to_json()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.name"><code class="docutils literal notranslate"><span class="pre">Block.name()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Block.to_dict"><code class="docutils literal notranslate"><span class="pre">Block.to_dict()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle"><code class="docutils literal notranslate"><span class="pre">Circle</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.get_circle_perimeter"><code class="docutils literal notranslate"><span class="pre">Circle.get_circle_perimeter()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.stl_mesh"><code class="docutils literal notranslate"><span class="pre">Circle.stl_mesh()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.is_point_on_segment"><code class="docutils literal notranslate"><span class="pre">Circle.is_point_on_segment()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.is_point_on_any_segment"><code class="docutils literal notranslate"><span class="pre">Circle.is_point_on_any_segment()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.split_perimeter_points"><code class="docutils literal notranslate"><span class="pre">Circle.split_perimeter_points()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.to_json"><code class="docutils literal notranslate"><span class="pre">Circle.to_json()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.name"><code class="docutils literal notranslate"><span class="pre">Circle.name()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.to_dict"><code class="docutils literal notranslate"><span class="pre">Circle.to_dict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.contains_gridpoint"><code class="docutils literal notranslate"><span class="pre">Circle.contains_gridpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.get_spacetime_reflection_data_d1q2"><code class="docutils literal notranslate"><span class="pre">Circle.get_spacetime_reflection_data_d1q2()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.get_spacetime_reflection_data_d2q4"><code class="docutils literal notranslate"><span class="pre">Circle.get_spacetime_reflection_data_d2q4()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.get_d2q4_volumetric_reflection_data"><code class="docutils literal notranslate"><span class="pre">Circle.get_d2q4_volumetric_reflection_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.expand_axis_segments"><code class="docutils literal notranslate"><span class="pre">Circle.expand_axis_segments()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.Circle.expand_diagonal_segments"><code class="docutils literal notranslate"><span class="pre">Circle.expand_diagonal_segments()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.DimensionalReflectionData"><code class="docutils literal notranslate"><span class="pre">DimensionalReflectionData</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.ReflectionPoint"><code class="docutils literal notranslate"><span class="pre">ReflectionPoint</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.ReflectionWall"><code class="docutils literal notranslate"><span class="pre">ReflectionWall</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.ReflectionResetEdge"><code class="docutils literal notranslate"><span class="pre">ReflectionResetEdge</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.SpaceTimePWReflectionData"><code class="docutils literal notranslate"><span class="pre">SpaceTimePWReflectionData</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.SpaceTimeVolumetricReflectionData"><code class="docutils literal notranslate"><span class="pre">SpaceTimeVolumetricReflectionData</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qlbm.lattice.geometry.SpaceTimeDiagonalReflectionData"><code class="docutils literal notranslate"><span class="pre">SpaceTimeDiagonalReflectionData</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
<div id="searchbox"></div></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/code/lattice.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, qlbm authors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>